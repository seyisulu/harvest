{"version":3,"sources":["wizard.js"],"names":["$","fn","wizard","isLastPane","$panes","index","$activeWizardPane","length","getButton","text","name","disable","classes","tooltip","addActionBarToActivePane","find","remove","disablePrevious","disableNext","config","redirectOnLastPane","append","gettext","hidePrevious","data","skip","skipTooltip","switchToPane","$navItems","removeClass","$activeNavItem","eq","addClass","next","previous","submit","$form","clearErrors","ajax","method","traditional","serializeForm","_this","this","arguments","undefined","filter","pubFuncs","isNumeric","on","prepend","done","window","location","fail","err","renderFormErrors","responseJSON","jQuery"],"mappings":"AAQA,cAAA,SAAUA,GACNA,EAAEC,GAAGC,OAAS,WAMV,QAASC,KACL,MAAOC,GAAOC,MAAMC,IAAsBF,EAAOG,OAAS,EAG9D,QAASC,GAAUC,EAAMC,EAAMC,EAASC,EAASC,GAC7C,MACI,iBAAmBH,EAAO,sBACME,EAAU,MAAQD,EAAS,WAAW,KAC5DE,EAAS,wDAA0DA,EAAU,IAAK,IACnF,IACLJ,EACJ,YAIR,QAASK,KACLV,EAAOW,KAAK,eAAeC,QAC3B,IAAIC,IAAkB,EAClBC,GAAc,CACqB,KAApCd,EAAOC,MAAMC,KACZW,GAAkB,GAEnBd,MAAiBgB,EAAOC,qBACvBF,GAAc,GAGlBZ,EAAkBe,OACd,iDAEQb,EAAUc,QAAQ,YAAa,WAAYL,EAAiB,0BAA4BE,EAAOI,aAAc,SAAS,KACtHf,EAAUL,IAAemB,QAAQ,UAAYA,QAAQ,QAAS,OAAQJ,EAAa,0BACvF,UACwC,SAAvCZ,EAAkBkB,KAAK,aAA0BL,EAAOM,KACzD,yBACIjB,EAAUc,QAAQ,QAAS,QAAQ,EAAO,yBAA0BH,EAAOO,aAC/E,SAAU,IACd,UAEJpB,EAAkBS,KAAK,2BAA2BF,UAGtD,QAASc,GAAatB,GAClBuB,EAAUC,YAAY,UACtBzB,EAAOyB,YAAY,UACnBC,EAAiBF,EAAUG,GAAG1B,GAC9BC,EAAoBF,EAAO2B,GAAG1B,GAC9ByB,EAAeE,SAAS,UACxB1B,EAAkB0B,SAAS,UAE3BlB,IAGJ,QAASmB,KACLN,EAAavB,EAAOC,MAAMC,GAAqB,GAGnD,QAAS4B,KACLP,EAAavB,EAAOC,MAAMC,GAAqB,GAGnD,QAAS6B,KACL,GAAIC,GAAQ9B,EAAkBS,KAAK,OAEnC,OADAsB,aAAYD,GACLpC,EAAEsC,MAAMC,OAAQ,OAAQC,aAAa,EAAMhB,KAAMiB,cAAcL,KAlE1E,GAAIM,GAAQC,KAHOxB,EAAMyB,UAAArC,QAAA,GAAAsC,SAAAD,UAAA,MAAGA,UAAA,GACxBhB,EAAYe,KAAK5B,KAAK,kBACtBX,EAASuC,KAAK5B,KAAK,gBACnBe,EAAiBF,EAAUb,KAAK,WAChCT,EAAoBF,EAAO0C,OAAO,WAoElCC,GAAYd,KAAAA,EAAMC,SAAAA,EAAUC,OAAAA,EAEhC,OAAGhB,KAAU4B,GACFA,EAAS5B,MACVnB,EAAEgD,UAAU7B,GAClBQ,EAAaR,IAEbwB,KAAKM,GAAG,QAAS,sBAAuB,WACpCP,EAAK3B,KAAK,uBAAuBmC,QAAQ,gDACtC/B,EAAOc,KACNd,EAAOc,KAAK3B,GAEZ6B,IAASgB,KAAK,WACPhC,EAAOC,oBAAsBjB,IAC5BiD,OAAOC,SAAWlC,EAAOC,mBAEzBa,MAELqB,KAAK,SAACC,GACLb,EAAK3B,KAAK,mBAAmBC,SAC7BwC,iBAAiBlD,EAAkBS,KAAK,QAASwC,EAAIE,kBAKjEd,KAAKM,GAAG,QAAS,0BAA2B,WACxCP,EAAK3B,KAAK,2BAA2BmC,QAAQ,gDAC1C/B,EAAOe,SACNf,EAAOe,SAAS5B,GAEhB4B,MAIRS,KAAKM,GAAG,QAAS,sBAAuB,WACjC9B,EAAOC,oBAAsBjB,IAC5BiD,OAAOC,SAAWlC,EAAOC,mBAEzBa,MAGRN,EAAa,IAEVgB,QAEbe","file":"wizard.js","sourcesContent":["/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n(function($) {\n    $.fn.wizard = function(config={}) {\n        let $navItems = this.find(\".wizard-nav li\");\n        let $panes = this.find(\".wizard-pane\");\n        let $activeNavItem = $navItems.find(\".active\");\n        let $activeWizardPane = $panes.filter(\".active\");\n\n        function isLastPane(){\n            return $panes.index($activeWizardPane) == $panes.length - 1;\n        }\n\n        function getButton(text, name, disable, classes, tooltip) {\n            return (\n                '<button name=\"' + name + '\"' +\n                         'class=\"btn btn-lg ' + classes + '\" ' + (disable? \"disabled\":\"\") +\n                         (tooltip? \"data-toggle='tooltip' data-placement='bottom' title='\" + tooltip + \"'\": \"\") +\n                         '>' +\n                    text +\n                '</button>'\n            );\n        }\n\n        function addActionBarToActivePane() {\n            $panes.find(\".action-bar\").remove();\n            let disablePrevious = false;\n            let disableNext = false;\n            if($panes.index($activeWizardPane) === 0) {\n                disablePrevious = true;\n            }\n            if(isLastPane() && !config.redirectOnLastPane) {\n                disableNext = true;\n            }\n\n            $activeWizardPane.append(\n                '<div class=\"action-bar\">' +\n                    '<div class=\"clearfix\">' +\n                        getButton(gettext(\"Previous\"), \"previous\", disablePrevious, \"btn-primary pull-left \" + (config.hidePrevious? \"hidden\":\"\")) +\n                        getButton(isLastPane() ? gettext(\"Finish\") : gettext(\"Next\"), \"next\", disableNext, \"btn-primary pull-right\") +\n                    '</div>' +\n                    ($activeWizardPane.data(\"can_skip\") === \"True\" || config.skip?\n                    '<div class=\"clearfix\">' +\n                        getButton(gettext(\"Skip\"), \"skip\", false, \"btn-default pull-right\", config.skipTooltip) +\n                    '</div>': '') +\n                '</div>'\n            );\n            $activeWizardPane.find('[data-toggle=\"tooltip\"]').tooltip();\n        }\n\n        function switchToPane(index) {\n            $navItems.removeClass(\"active\");\n            $panes.removeClass(\"active\");\n            $activeNavItem = $navItems.eq(index);\n            $activeWizardPane = $panes.eq(index);\n            $activeNavItem.addClass(\"active\");\n            $activeWizardPane.addClass(\"active\");\n\n            addActionBarToActivePane();\n        }\n\n        function next() {\n            switchToPane($panes.index($activeWizardPane) + 1);\n        }\n\n        function previous() {\n            switchToPane($panes.index($activeWizardPane) - 1);\n        }\n\n        function submit() {\n            let $form = $activeWizardPane.find(\"form\");\n            clearErrors($form);\n            return $.ajax({method: \"POST\", traditional: true, data: serializeForm($form)});\n        }\n\n        var pubFuncs = {next, previous, submit};\n\n        if(config in pubFuncs){\n            return pubFuncs[config]();\n        } else if($.isNumeric(config)){\n            switchToPane(config);\n        } else {\n            this.on(\"click\", \"button[name='next']\", () => {\n                this.find(\"button[name='next']\").prepend('<i class=\"fa fa-spinner fa-pulse fa-fw\"></i>');\n                if(config.next) {\n                    config.next($activeWizardPane);\n                } else {\n                    submit().done(() => {\n                        if(config.redirectOnLastPane && isLastPane()){\n                            window.location = config.redirectOnLastPane;\n                        } else {\n                            next();\n                        }\n                    }).fail((err) => {\n                        this.find(\"i.fa.fa-spinner\").remove();\n                        renderFormErrors($activeWizardPane.find(\"form\"), err.responseJSON);\n                    });\n                }\n            });\n\n            this.on(\"click\", \"button[name='previous']\", () => {\n                this.find(\"button[name='previous']\").prepend('<i class=\"fa fa-spinner fa-pulse fa-fw\"></i>');\n                if(config.previous) {\n                    config.previous($activeWizardPane);\n                } else {\n                    previous();\n                }\n            });\n\n            this.on(\"click\", \"button[name='skip']\", () => {\n                if(config.redirectOnLastPane && isLastPane()){\n                    window.location = config.redirectOnLastPane;\n                } else {\n                    next();\n                }\n            });\n            switchToPane(0);\n        }\n        return this;\n    };\n}(jQuery));\n"],"sourceRoot":"/source/"}