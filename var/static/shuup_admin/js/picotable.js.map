{"version":3,"sources":["picotable.js"],"names":["Picotable","m","storage","addDummies","pageLinks","nDummy","i","length","_page","li","key","className","href","splice","paginator","paginationData","setPage","nItems","callback","withAttr","currentPage","pageNum","pageLink","page","title","rel","onclick","nPages","Math","abs","cx","active","push","prevLink","disabled","gettext","nextLink","debounceChangeConfig","timeout","el","isInit","context","oninput","debouncedOnInput","Util","debounce","onchange","buildColumnChoiceFilter","ctrl","col","value","setFilterValueFromSelect","valueJS","JSON","parse","this","setFilterValue","id","select2Config","$","select2","select","config","filter","stringify","map","choices","choice","getDefaultValues","data","vm","filters","columns","defaultChoice","buildColumnRangeFilter","setFilterValueFromInput","which","filterObj","extend","getFilterValue","newValue","trim","attrs","type","range","useDatepicker","val","undefined","minInput","stringValue","min","placeholder","lang","RANGE_FROM","call","datePicker","maxInput","max","RANGE_TO","buildColumnTextFilter","input","text","interpolate","buildColumnFilter","buildColumnHeaderCell","columnNumber","sortIndicator","classSet","","columnOnClick","sortable","currentSort","sort","thisColSort","sortIcon","setSortColumn","columnSettings","massActions","colspan","buildColumnFilterCell","filterControl","renderTable","defaultValues","filterValues","columnHeaderCells","columnFilterCells","any","property","thead","footColspan","footCell","pagination","tfoot","isPick","pickId","rows","items","item","rowNumber","rowSettings","_id","saveCheck","isChecked","idx","content","class","boundPartial","checked","raw","trust","linked","pickObject","_url","preventSelect","tbody","mass_actions_class","event","stopPropagation","getMobileFilterModal","showMobileFilterSettings","resetFilters","isEmpty","RESET","getMobileSortSelect","sortOptions","SORT_BY","SORT_ASC","SORT_DESC","unshift","SORT_DEFAULT","refresh","so","renderMobileTable","listItems","_abstract","line","rowClass","v","colContent","linkAttrs","element","_linked_in_mobile","renderMassActions","itemCount","initialMassActions","concat","allItemsSelected","doMassAction","obj","data-redirects","redirects","data-redirect-url","redirect_url","renderHeader","itemInfo","for","ITEMS_PER_PAGE","perPage","perPageChoices","RESET_FILTERS","PicotableView","showHeader","renderMode","PicotableController","random","url","prop","filterEnabled","checkboxes","setRenderMode","mode","oldMode","adaptRenderMode","width","window","innerWidth","setSource","colId","sortValue","test","omitNulls","resetCheckboxes","object","originalValues","toggleClass","getMassActionResponse","xhr","status","filename","disposition","getResponseHeader","indexOf","filenameRegex","matches","exec","replace","blob","Blob","response","navigator","msSaveBlob","URL","webkitURL","downloadUrl","createObjectURL","a","document","createElement","download","location","body","appendChild","click","savedValue","setTimeout","Messages","enqueue","tags","revokeObjectURL","selectAllProducts","selectAllListedProducts","alert","confirm","xhrConfig","setRequestHeader","ShuupAdminConfig","csrf","responseType","payload","action","values","request","method","pathname","extract","newPage","isNaN","params","route","parseQueryString","decodeURI","search","jq","then","saveSettings","setItem","loadSettings","getItem","pickMatch","opener","postMessage","pick","preventDefault","isInitialized","datetimepicker","format","autoclose","todayBtn","todayHighlight","fontAwesome","minView","addEventListener","deferred","onerror","e","toString","match","constructor","require","propertyName","Array","isArray","Object","keys","some","target","arguments","hasOwnProperty","outputObject","func","wait","debounced","args","timestamp","Date","getTime","startComputation","later","immediate","result","apply","elapsed","endComputation","k","thisArg","partialArgs","slice","fArgs","MASS_ACTIONS","classValues","flag","join","generator","container","dataSourceUrl","mount","view","controller","localStorage","module","exports","define","amd"],"mappings":"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","file":"picotable.js","sourcesContent":["/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n/* eslint-disable no-plusplus, prefer-const, curly, no-bitwise */\n/* exported Picotable */\n/* global alert, require */\nconst Picotable = (function(m, storage) {\n    \"use strict\";\n    m = m || require(\"mithril\");\n\n    const Util = (function() {\n        function property(propertyName) {\n            return function(obj) {\n                return obj[propertyName];\n            };\n        }\n\n        function map(obj, callback) {\n            if (Array.isArray(obj)) {\n                return obj.map(callback);\n            }\n            return Object.keys(obj).map(function(key) {\n                return callback(obj[key], key, obj);\n            });\n        }\n\n        function any(obj, callback) {\n            if (Array.isArray(obj)) {\n                return obj.some(callback);\n            }\n            return Object.keys(obj).some(function(key) {\n                return callback(obj[key], key, obj);\n            });\n        }\n\n        function extend(/*...*/) {\n            const target = arguments[0];\n            for (var i = 1; i < arguments.length; i++) {\n                for (var key in arguments[i]) {\n                    if (arguments[i].hasOwnProperty(key)) {\n                        target[key] = arguments[i][key];\n                    }\n                }\n            }\n            return target;\n        }\n\n        function trim(value) {\n            return (\"\" + value).replace(/^\\s+|\\s+$/g, \"\");\n        }\n\n        function omitNulls(object) {\n            const outputObject = {};\n            map(object, function(value, key) {\n                if (value !== null) {\n                    outputObject[key] = value;\n                }\n            });\n            return outputObject;\n        }\n\n        function debounce(func, wait, immediate=false) {\n            let context, args, timestamp, timeout, result;\n\n            function debounced() {\n                context = this;\n                args = arguments;\n                timestamp = new Date().getTime();\n\n                if (!timeout) {\n                    m.startComputation();\n\n                    timeout = setTimeout(later, wait);\n\n                    if (immediate) {\n                        result = func.apply(context, args);\n                        context = args = null;\n                    }\n                }\n                return result;\n            }\n\n            function later() {\n                const elapsed = new Date().getTime() - timestamp;\n\n                if (elapsed < wait && elapsed > 0) {\n                    timeout = setTimeout(later, wait - elapsed);\n                } else {\n                    timeout = null;\n\n                    if (!immediate) {\n                        result = func.apply(context, args);\n                        context = args = null;\n                    }\n                    m.endComputation();\n                }\n            }\n\n            return debounced;\n        }\n\n        function stringValue(obj) {\n            if (obj === null || obj === undefined) {\n                return \"\";\n            }\n            if (Array.isArray(obj) && obj.length === 0) {\n                return \"\";\n            }\n            return \"\" + obj;\n        }\n\n        function isEmpty(obj) {\n            if (obj.length) {\n                return false;\n            }\n            for (var k in obj) {\n                if (obj.hasOwnProperty(k)) {\n                    return false;\n                }\n            }\n            return true;\n        }\n\n        function boundPartial(thisArg, func/*, args */) {\n            const partialArgs = [].slice.call(arguments, 2);\n            return function(/* args */) {\n                const fArgs = partialArgs.concat([].slice.call(arguments));\n                return func.apply(thisArg, fArgs);\n            };\n        }\n\n        return {\n            property: property,\n            map: map,\n            any: any,\n            extend: extend,\n            trim: trim,\n            omitNulls: omitNulls,\n            debounce: debounce,\n            stringValue: stringValue,\n            isEmpty: isEmpty,\n            boundPartial: boundPartial\n        };\n    }());\n\n    const lang = {\n        \"MASS_ACTIONS\": gettext(\"Mass actions\"),\n        \"RANGE_FROM\": gettext(\"From\"),\n        \"RANGE_TO\": gettext(\"To\"),\n        \"ITEMS_PER_PAGE\": gettext(\"Items per page\"),\n        \"RESET_FILTERS\": gettext(\"Reset filters\"),\n        \"RESET\": gettext(\"Reset\"),\n        \"SORT_BY\": gettext(\"Sort by\"),\n        \"SORT_ASC\": gettext(\"ascending\"),\n        \"SORT_DESC\": gettext(\"descending\"),\n        \"SORT_DEFAULT\": gettext(\"Default sorting\")\n    };\n\n    const cx = function generateClassName(classSet) {\n        var classValues = [];\n        Util.map((classSet || {}), function(flag, key) {\n            var className = null;\n            if (key === \"\") { // The empty string as a class set means the entire value is used if not empty\n                className = (flag && flag.length ? \"\" + flag : null);\n            } else {\n                className = flag ? key : null;\n            }\n            if (className) classValues.push(className);\n        });\n        return classValues.join(\" \");\n    };\n\n    function addDummies(pageLinks) {\n        var nDummy = 0;\n        for (var i = 1; i < pageLinks.length; i++) {\n            if (pageLinks[i]._page !== pageLinks[i - 1]._page + 1) {\n                const li = m(\"li\", {key: \"dummy\" + (nDummy++), className: \"disabled\"}, m(\"a\", {href: \"#\"}, \"\\u22EF\"));\n                pageLinks.splice(i, 0, li);\n                i++;\n            }\n        }\n    }\n\n    function paginator(paginationData, setPage) {\n        if (paginationData.nItems === 0) return m(\"nav\");\n        var callback = m.withAttr(\"rel\", setPage);\n        var currentPage = paginationData.pageNum;\n        var pageLinks = [];\n        var pageLink = function(page, title) {\n            return m(\"a\", {rel: page, href: \"#\", onclick: callback}, title || page);\n        };\n        for (var page = 1; page <= paginationData.nPages; page++) {\n            if (page === 1 || page === paginationData.nPages || Math.abs(page - currentPage) <= 2) {\n                var li = m(\"li\", {key: page, className: cx({active: currentPage === page})}, pageLink(page));\n                li._page = page;\n                pageLinks.push(li);\n            }\n        }\n        addDummies(pageLinks);\n        var prevLink = m(\"li\", {\n            key: \"previous\",\n            className: cx({disabled: currentPage === 1})\n        }, pageLink(currentPage - 1, gettext(\"Previous\")));\n        var nextLink = m(\"li\", {\n            key: \"next\",\n            className: cx({disabled: currentPage === paginationData.nPages})\n        }, pageLink(currentPage + 1, gettext(\"Next\")));\n        return m(\"nav\", m(\"ul.pagination\", prevLink, pageLinks, nextLink));\n    }\n\n    function debounceChangeConfig(timeout) {\n        return function(el, isInit, context) {\n            if (!isInit) {\n                el.oninput = context.debouncedOnInput = Util.debounce(el.onchange, timeout);\n            }\n        };\n    }\n\n    function buildColumnChoiceFilter(ctrl, col, value) {\n        var setFilterValueFromSelect = function() {\n            var valueJS = JSON.parse(this.value);\n            ctrl.setFilterValue(col.id, valueJS);\n        };\n        var select2Config = function() {\n            return function(el, isInit) {\n                if(!isInit) {\n                    $(el).select2();\n                }\n            };\n        };\n\n        var select = m(\"select.form-control\", {\n            config: col.filter.select2? select2Config(): null,\n            value: JSON.stringify(value),\n            onchange: setFilterValueFromSelect\n        }, Util.map(col.filter.choices, function(choice) {\n            return m(\"option\", {value: JSON.stringify(choice[0]), key: choice[0]}, choice[1]);\n        }));\n        return m(\"div.choice-filter\", select);\n    }\n\n    function getDefaultValues(ctrl) {\n        const data = ctrl.vm.data();\n        const filters = {};\n        for (var i = 0; i < data.columns.length; i++) {\n            if (data.columns[i].filter){\n                var value = data.columns[i].filter.defaultChoice;\n                if (value) {\n                    filters[data.columns[i].id] = value;\n                }\n            }\n        }\n\n        return filters;\n    }\n\n    function buildColumnRangeFilter(ctrl, col, value) {\n        var setFilterValueFromInput = function(which) {\n            const filterObj = Util.extend({}, ctrl.getFilterValue(col.id) || {}); // Copy current filter object\n            var newValue = this.value;\n            if (!Util.trim(newValue)) {\n                newValue = null;\n            }\n            filterObj[which] = newValue;\n            ctrl.setFilterValue(col.id, filterObj);\n        };\n        var attrs = {\"type\": col.filter.range.type || \"text\"};\n        var useDatepicker = false;\n        if(attrs[\"type\"] == \"date\") {\n            // use a normal text input since mixing a date input and the datepicker together works weird in chrome\n            useDatepicker = true;\n            attrs[\"type\"] = \"text\";\n        }\n        Util.map([\"min\", \"max\", \"step\"], function(key) {\n            var val = col.filter.range[key];\n            if (!(val === undefined || val === null)) {\n                attrs[key] = val;\n                attrs.type = \"number\";  // Any of these set means we're talking about numbers\n            }\n        });\n        value = value || {};\n        var minInput = m(\"input.form-control\", Util.extend({}, attrs, {\n            value: Util.stringValue(value.min),\n            placeholder: lang.RANGE_FROM,\n            onchange: function() {\n                setFilterValueFromInput.call(this, \"min\");\n            },\n            config: useDatepicker? ctrl.datePicker() : debounceChangeConfig(500)\n        }));\n        var maxInput = m(\"input.form-control\", Util.extend({}, attrs, {\n            value: Util.stringValue(value.max),\n            placeholder: lang.RANGE_TO,\n            onchange: function() {\n                setFilterValueFromInput.call(this, \"max\");\n            },\n            config: useDatepicker? ctrl.datePicker() : debounceChangeConfig(500)\n        }));\n        return m(\"div.range-filter\", [\n            m(\"div.input-wrapper.min\", {key: \"min\"}, minInput),\n            m(\"div.input-wrapper.max\", {key: \"max\"}, maxInput)\n        ]);\n    }\n\n    function buildColumnTextFilter(ctrl, col, value) {\n        var setFilterValueFromInput = function() {\n            ctrl.setFilterValue(col.id, this.value);\n        };\n\n        var input = m(\"input.form-control\", {\n            type: col.filter.text.type || \"text\",\n            value: Util.stringValue(value),\n            placeholder: col.filter.placeholder || interpolate(gettext(\"Filter by %s\"), [col.title]),\n            onchange: setFilterValueFromInput,\n            config: debounceChangeConfig(500)\n        });\n        return m(\"div.text-filter\", input);\n    }\n\n    function buildColumnFilter(ctrl, col) {\n        var value = ctrl.getFilterValue(col.id);\n        if (col.filter.choices) {\n            return buildColumnChoiceFilter(ctrl, col, value);\n        }\n        if (col.filter.range) {\n            return buildColumnRangeFilter(ctrl, col, value);\n        }\n        if (col.filter.text) {\n            return buildColumnTextFilter(ctrl, col, value);\n        }\n    }\n\n    function buildColumnHeaderCell(ctrl, col, columnNumber) {\n        var sortIndicator = null;\n        var classSet = {\"\": col.className};\n        var columnOnClick = null;\n        if (col.sortable) {\n            var currentSort = ctrl.vm.sort();\n            var thisColSort = null;\n            if (currentSort === \"+\" + col.id) {\n                thisColSort = \"asc\";\n            }\n            if (currentSort === \"-\" + col.id) {\n                thisColSort = \"desc\";\n            }\n            var sortIcon = \"fa-sort\" + (thisColSort ? \"-\" + thisColSort : \"\");\n            sortIndicator = m(\"i.fa.\" + sortIcon);\n            classSet.sortable = true;\n            if (thisColSort) {\n                classSet[\"sorted-\" + thisColSort] = true;\n            }\n            columnOnClick = function() {\n                ctrl.setSortColumn(col.id);\n            };\n        }\n        var columnSettings = {key: col.id, className: cx(classSet), onclick: columnOnClick};\n        var massActions = (ctrl.vm.data() ? ctrl.vm.data().massActions : null);\n        if (massActions.length) {\n            if (columnNumber == 0) {\n                columnSettings.className += \" hidden\";\n            }\n            if (columnNumber == 1) {\n                columnSettings.colspan = 2;\n            }\n        }\n        return m(\"th\", columnSettings, [sortIndicator, \" \", col.title]);\n    }\n\n    function buildColumnFilterCell(ctrl, col, columnNumber) {\n        var filterControl = null;\n        if (col.filter) {\n            filterControl = buildColumnFilter(ctrl, col);\n        }\n        var columnSettings = {key: col.id, className: col.className || \"\"};\n        var massActions = (ctrl.vm.data() ? ctrl.vm.data().massActions : null);\n        if (massActions.length) {\n            if (columnNumber == 0) {\n                columnSettings.className += \" hidden\";\n            }\n            if (columnNumber == 1) {\n                columnSettings.colspan = 2;\n            }\n        }\n        return m(\"th\", columnSettings, [filterControl]);\n    }\n\n    function renderTable(ctrl) {\n        var data = ctrl.vm.data();\n        if (data === null) {  // Not loaded, don't return anything\n            return;\n        }\n\n        // Set default filter values\n        var defaultValues = Util.extend(getDefaultValues(ctrl), ctrl.vm.filterValues());\n        ctrl.vm.filterValues(defaultValues);\n\n        // Build header\n        var columnHeaderCells = Util.map(data.columns, function(col, columnNumber) {\n            return buildColumnHeaderCell(ctrl, col, columnNumber);\n        });\n        var columnFilterCells = (\n            Util.any(data.columns, Util.property(\"filter\")) ?\n            Util.map(data.columns, function(col, columnNumber) {\n                return buildColumnFilterCell(ctrl, col, columnNumber);\n            }) : null\n        );\n        var thead = m(\"thead\", [\n            m(\"tr.headers\", columnHeaderCells),\n            (columnFilterCells ? m(\"tr.filters\", columnFilterCells) : null)\n        ]);\n\n        // Build footer\n        var footColspan = data.columns.length;\n        var footCell = m(\"td\", {colspan: footColspan}, paginator(data.pagination, ctrl.setPage));\n        var tfoot = m(\"tfoot\", [m(\"tr\", footCell)]);\n\n        var massActions = (ctrl.vm.data() ? ctrl.vm.data().massActions : null);\n\n        // Build body\n        var isPick = !!ctrl.vm.pickId();\n        var rows = Util.map(data.items, function(item, rowNumber) {\n            var rowSettings = {key: \"item-\" + item._id};\n            if (massActions.length) {\n                rowSettings.onclick = (function() {\n                    ctrl.saveCheck(item);\n                });\n                rowSettings.class = ctrl.isChecked(item) ? \"active\" : \"\";\n            }\n            return m(\"tr\", rowSettings, Util.map(data.columns, function(col, idx) {\n                if (idx == 0 && massActions.length) {\n                    var content = m(\"input[type=checkbox]\", {\n                        value: item.type + \"-\" + item._id,\n                        class: \"row-selection\",\n                        onclick: Util.boundPartial(ctrl, ctrl.saveCheck, item),\n                        checked: ctrl.isChecked(item)\n                    });\n                }\n                else {\n                    var content = item[col.id] || \"\";\n                }\n                if (col.raw) content = m.trust(content);\n                if (col.linked) {\n                    if (isPick) {\n                        content = m(\"a\", {\n                            href: \"#\",\n                            onclick: Util.boundPartial(ctrl, ctrl.pickObject, item)\n                        }, content);\n                    } else if (item._url) {\n                        content = m(\"a\", {href: item._url, onclick:preventSelect}, content);\n                    }\n                }\n                return m(\"td\", {key: \"col-\" + col.id, className: col.className || \"\"}, [content]);\n            }));\n        });\n        var tbody = m(\"tbody\", rows);\n        var mass_actions_class = massActions.length ? \".has-mass-actions\" : \"\";\n        return m(\"table.table.table-striped.picotable-table\" + mass_actions_class, [thead, tfoot, tbody]);\n    }\n\n    function preventSelect(event) {\n        event.stopPropagation();\n    }\n\n    function getMobileFilterModal(ctrl) {\n        var data = ctrl.vm.data();\n        var filters = Util.map(data.columns, function(col) {\n            if (!col.filter) return null;\n            return m(\"div.single-filter\",\n                m(\"h3\", col.title),\n                buildColumnFilter(ctrl, col)\n            );\n        });\n        return m(\"div.mobile-filters.shuup-modal-bg\", {key: \"mobileFilterModal\"}, [\n            m(\"div.shuup-modal-container\", [\n                m(\"div.shuup-modal-header\", [\n                    m(\"h2.pull-left\", [m(\"i.fa.fa-filter\")], gettext(\"Filters\")),\n                    m(\"button.btn.btn-success.pull-right\", {\n                        onclick: function() {\n                            ctrl.vm.showMobileFilterSettings(false);\n                        }\n                    }, \"Done\"),\n                    m(\n                        \"button.btn.btn-gray.btn-inverse.pull-right\",\n                        {\n                            onclick: ctrl.resetFilters,\n                            disabled: Util.isEmpty(ctrl.vm.filterValues())\n                        },\n                        lang.RESET\n                    )\n                ]),\n                m(\"div.mobile-filters-content\", filters)\n            ])\n        ]);\n    }\n\n    function getMobileSortSelect(ctrl) {\n        var data = ctrl.vm.data();\n        var sortOptions = [];\n        Util.map(data.columns, function(col) {\n            if (col.sortable) {\n                sortOptions.push({\n                    value: \"+\" + col.id,\n                    text: \"\" + lang.SORT_BY + \" \" + col.title + \" \" + lang.SORT_ASC\n                });\n                sortOptions.push({\n                    value: \"-\" + col.id,\n                    text: \"\" + lang.SORT_BY + \" \" + col.title + \" \" + lang.SORT_DESC\n                });\n            }\n        });\n        if (!sortOptions.length) return;\n        sortOptions.unshift({value: \"\", text: lang.SORT_DEFAULT});\n\n        return m(\"select.picotable-mobile-sort.form-control\",\n            {\n                id: \"mobile-sort-select\",\n                value: (ctrl.vm.sort() || \"\"),\n                onchange: m.withAttr(\"value\", function(value) {\n                    ctrl.setSortColumn(value);\n                    ctrl.refresh();\n                })\n            },\n            Util.map(sortOptions, function(so) {\n                return m(\"option\", {value: so.value}, so.text);\n            })\n        );\n    }\n\n    function renderMobileTable(ctrl) {\n        var data = ctrl.vm.data();\n        if (data === null) return; // Not loaded, don't return anything\n\n        // Set default filter values\n        var defaultValues = Util.extend(getDefaultValues(ctrl), ctrl.vm.filterValues());\n        ctrl.vm.filterValues(defaultValues);\n\n        var isPick = !!ctrl.vm.pickId();\n        var listItems = Util.map(data.items, function(item) {\n            var content = null;\n            if (item._abstract && item._abstract.length) {\n                content = Util.map(item._abstract, function(line) {\n                    if (!line) return;\n                    if (typeof line === \"string\") line = {text: line};\n                    if (!line.text) return;\n                    if (line.raw) line.text = m.trust(line.raw);\n                    var rowClass = \"div.inner-row.\" +\n                        (line.title ? \"with-title\" : \"\") +\n                        (line.class ? \".\" + line.class : \"\");\n                    return m(rowClass, [\n                        (line.title ? m(\"div.column.title\", line.title) : null),\n                        m(\"div.column\", line.text)\n                    ]);\n                });\n                if (!Util.any(content, function(v) {\n                        return !!v;\n                    })) {\n                    // Not a single valid line\n                    content = null;\n                }\n            }\n            if (content === null) {\n                content = Util.map(data.columns, function(col) {\n                    var colContent = item[col.id] || \"\";\n                    if (col.raw) colContent = m.trust(colContent);\n                    return m(\"div.inner-row.with-title\", [\n                        m(\"div.column.title\", col.title),\n                        m(\"div.column\", colContent)\n                    ]);\n                });\n            }\n            var linkAttrs = {href: item._url};\n            if (isPick) {\n                linkAttrs.onclick = Util.boundPartial(ctrl, ctrl.pickObject, item);\n                linkAttrs.href = \"#\";\n            }\n            var element = (item._linked_in_mobile ? m(\"a.inner\", linkAttrs, content) : m(\"span.inner\", content));\n            return m(\"div.list-element\", element);\n        });\n        return m(\"div.mobile\", [\n            m(\"div.row.mobile-header\", [\n                m(\"div.col-sm-6\", [\n                    m(\"button.btn.btn-info.btn-block.toggle-btn\",\n                        {\n                            onclick: function() {\n                                ctrl.vm.showMobileFilterSettings(true);\n                            }\n                        },\n                        [m(\"i.fa.fa-filter\")], \"Show filters\"\n                    )\n                ]),\n                m(\"div.col-sm-6\", [\n                    m(\"div.mobile-sort\", getMobileSortSelect(ctrl))\n                ])\n            ]),\n            (ctrl.vm.showMobileFilterSettings() ? getMobileFilterModal(ctrl) : null),\n            m(\"hr\"),\n            m(\"div.mobile-items\", listItems),\n            paginator(data.pagination, ctrl.setPage)\n        ]);\n    }\n\n    function renderMassActions(ctrl) {\n        var massActions = (ctrl.vm.data() ? ctrl.vm.data().massActions : null);\n        if (massActions == null) {\n            return \"\";\n        }\n        var select2Config = function() {\n            return function(el, isInit) {\n                if(!isInit) {\n                    $(el).select2();\n                }\n            };\n        };\n\n        const itemCount = ctrl.vm.data().items.length;\n        const initialMassActions = [\n            {key: 0, value: gettext(\"Select Action\")},\n            {key: \"unselect_all\", value: gettext(\"Clear Selections\")},\n            {key: \"select_listed\", value: gettext(\"Select All\")},\n            {key: \"select_all\", value: interpolate(gettext(\"Select All %s Items\"), [itemCount])},\n        ];\n        massActions = initialMassActions.concat(massActions);\n\n        return m(\"div.picotable-mass-actions\", [\n            (ctrl.vm.allItemsSelected() ? m(\"p\", interpolate(gettext(\"All %s Items Selected\"), [itemCount])) : null),\n            m(\"select.picotable-mass-action-select.form-control\",\n                {\n                    id: \"mass-action-select\" + ctrl.id,\n                    config: select2Config(),\n                    value: 0,\n                    onchange: m.withAttr(\"value\", function(value) {\n                        ctrl.doMassAction(value);\n                    })\n                },\n                Util.map(massActions, function(obj) {\n                    return m(\"option\", {\n                        value: obj.key,\n                        \"data-redirects\": obj.redirects,\n                        \"data-redirect-url\": obj.redirect_url\n                    }, obj.value);\n                })\n            ),\n        ]);\n    }\n\n    function renderHeader(ctrl) {\n        var itemInfo = (ctrl.vm.data() ? ctrl.vm.data().itemInfo : null);\n        return m(\"div.picotable-header\", [\n            renderMassActions(ctrl),\n            m(\"div.picotable-items-per-page-ctr\", [\n                m(\"label\", {\"for\": \"pipps\" + ctrl.id}, lang.ITEMS_PER_PAGE),\n                m(\"select.picotable-items-per-page-select.form-control\",\n                    {\n                        id: \"pipps\" + ctrl.id,\n                        value: ctrl.vm.perPage(),\n                        onchange: m.withAttr(\"value\", function(value) {\n                            ctrl.vm.perPage(value);\n                            ctrl.refresh();\n                        })\n                    },\n                    Util.map(ctrl.vm.perPageChoices(), function(value) {\n                        return m(\"option\", {value: value}, value);\n                    })\n                )\n            ]),\n            m(\"div.picotable-item-info\", itemInfo),\n            m(\"div.picotable-reset-filters-ctr\",\n                m(\n                    \"button.picotable-reset-filters-btn.btn.btn-gray.btn-inverse\",\n                    {\n                        onclick: ctrl.resetFilters,\n                        disabled: Util.isEmpty(ctrl.vm.filterValues())\n                    },\n                    lang.RESET_FILTERS\n                )\n            )\n        ]);\n    }\n\n    function PicotableView(ctrl) {\n        return m(\"div.table-view\", [\n            (ctrl.vm.showHeader() ? renderHeader(ctrl) : null),\n            (ctrl.vm.renderMode() === \"mobile\" ? renderMobileTable(ctrl) : renderTable(ctrl))\n        ]);\n    }\n\n    function PicotableController() {\n        var ctrl = this;\n        ctrl.id = \"\" + 0 | (Math.random() * 0x7FFFFFF);\n        ctrl.vm = {\n            url: m.prop(null),\n            sort: m.prop(null),\n            filterEnabled: m.prop({}),\n            filterValues: m.prop({}),\n            checkboxes: m.prop([]),\n            allItemsSelected: m.prop(false),\n            page: m.prop(1),\n            perPage: m.prop(20),\n            perPageChoices: m.prop([20, 50, 100, 200]),\n            showHeader: m.prop(true),\n            data: m.prop(null),\n            renderMode: m.prop(\"normal\"),\n            showMobileFilterSettings: m.prop(false),\n            pickId: m.prop(null)\n        };\n        ctrl.setRenderMode = function(mode) {\n            var oldMode = ctrl.vm.renderMode();\n            ctrl.vm.renderMode(mode);\n            if (mode !== oldMode) ctrl.refresh();\n        };\n        ctrl.adaptRenderMode = function() {\n            var width = window.innerWidth;\n            ctrl.setRenderMode(width < 992 ? \"mobile\" : \"normal\");\n        };\n        ctrl.setSource = function(url) {\n            ctrl.vm.url(url);\n            ctrl.refresh();\n        };\n        ctrl.setSortColumn = function(colId) {\n            var sortValue = null;\n            if (colId && colId.length && colId !== \"null\") {\n                if (/^[+-]/.test(colId)) {\n                    sortValue = colId;\n                } else {\n                    var currentSort = ctrl.vm.sort();\n                    if (currentSort === \"+\" + colId) sortValue = \"-\" + colId;\n                    else if (currentSort === \"-\" + colId) sortValue = null;\n                    else sortValue = \"+\" + colId;\n                }\n            }\n            ctrl.vm.sort(sortValue);\n            ctrl.refresh();\n        };\n        ctrl.getFilterValue = function(colId) {\n            return ctrl.vm.filterValues()[colId];\n        };\n        ctrl.setFilterValue = function(colId, value) {\n            var filters = ctrl.vm.filterValues();\n            if (typeof value === \"string\" && Util.trim(value) === \"\") {\n                // An empty string is invalid for filtering\n                value = null;\n            }\n            filters[colId] = value;\n            filters = Util.omitNulls(filters);\n            ctrl.vm.filterValues(filters);\n            ctrl.refresh();\n        };\n        ctrl.resetFilters = function() {\n            ctrl.vm.filterValues({});\n            ctrl.refresh();\n        };\n        ctrl.resetCheckboxes = function() {\n            ctrl.vm.allItemsSelected(false);\n            ctrl.vm.checkboxes([]);\n        };\n        ctrl.saveCheck = function(object) {\n            var originalValues = ctrl.vm.checkboxes();\n            var items = originalValues.filter(function(i) { return i !== object._id; });\n\n            if (items.length < originalValues.length) {\n                ctrl.vm.checkboxes(items);\n            }\n            else {\n                originalValues.push(object._id);\n                ctrl.vm.checkboxes(originalValues);\n            }\n\n            $(object).toggleClass(\"active\");\n        };\n        ctrl.isChecked = function(object) {\n            var originalValues = ctrl.vm.checkboxes();\n            const checked = originalValues.filter(function(i) { return i === object._id; });\n            return checked.length > 0;\n        };\n        ctrl.getMassActionResponse = function(xhr) {\n            if (xhr.status === 200) {\n                var filename = \"\";\n                var disposition = xhr.getResponseHeader('Content-Disposition');\n                if (disposition && disposition.indexOf('attachment') !== -1) {\n                    var filenameRegex = /filename[^;=\\n]*=((['\"]).*?\\2|[^;\\n]*)/;\n                    var matches = filenameRegex.exec(disposition);\n                    if (matches != null && matches[1]) filename = matches[1].replace(/['\"]/g, '');\n                }\n                var type = xhr.getResponseHeader('Content-Type');\n\n                var blob = new Blob([xhr.response], { type: type });\n                if (typeof window.navigator.msSaveBlob !== 'undefined') {\n                    // IE workaround for \"HTML7007: One or more blob URLs\n                    // were revoked by closing the blob for which they were\n                    // created. These URLs will no longer resolve as the data\n                    // backing the URL has been freed.\"\n                    window.navigator.msSaveBlob(blob, filename);\n                }\n                else {\n                    var URL = window.URL || window.webkitURL;\n                    var downloadUrl = URL.createObjectURL(blob);\n\n                    if (filename) {\n                        // use HTML5 a[download] attribute to specify filename\n                        var a = document.createElement(\"a\");\n                        // safari doesn't support this yet\n                        if (typeof a.download === 'undefined') {\n                            window.location = downloadUrl;\n                        } else {\n                            a.href = downloadUrl;\n                            a.download = filename;\n                            document.body.appendChild(a);\n                            a.click();\n                        }\n                    }\n                    else {\n                        var redirects = $(\"option[value=\"+window.savedValue+\"]\").data(\"redirects\");\n                        if (redirects) {\n                            window.location = $(\"option[value=\"+window.savedValue+\"]\").data(\"redirect-url\");\n                        }\n                        ctrl.resetCheckboxes();\n                        $(\".picotable-mass-action-select\").val(0);\n                        ctrl.refresh();\n                        setTimeout(function() {\n                            window.Messages.enqueue({tags: \"success\", text: gettext(\"Mass Action complete.\")});\n                        }, 1000);\n                    }\n                    setTimeout(function () { URL.revokeObjectURL(downloadUrl); }, 100); // cleanup\n                }\n            }\n        };\n        ctrl.doMassAction = function(value) {\n            switch (value) {\n                case \"select_all\":\n                    ctrl.selectAllProducts();\n                    return;\n                case \"select_listed\":\n                    ctrl.selectAllListedProducts();\n                    return;\n                case \"unselect_all\":\n                    ctrl.resetCheckboxes();\n                    return;\n            }\n\n            var originalValues = ctrl.vm.checkboxes();\n            window.savedValue = value;\n            if (originalValues.length == 0) {\n                alert(gettext(\"You haven't selected anything\"));\n                return;\n            }\n            if(value == 0) {\n                return;\n            }\n\n            if (!confirm(gettext(\"Confirm action by clicking OK!\"))) {\n                $(\".picotable-mass-action-select\").val(0);\n                ctrl.refresh();\n                return;\n            }\n\n            var xhrConfig = function(xhr) {\n                xhr.setRequestHeader(\"X-CSRFToken\", window.ShuupAdminConfig.csrf);\n                xhr.setRequestHeader('Content-type', 'application/json');\n                xhr.responseType = \"blob\";\n            };\n            var payload = {\n                \"action\": value,\n                \"values\": (ctrl.vm.allItemsSelected() ? \"all\" : originalValues)\n            };\n            m.request({\n                method: \"POST\",\n                url: window.location.pathname,\n                data: payload,\n                extract:ctrl.getMassActionResponse,\n                config: xhrConfig\n            });\n        };\n        ctrl.selectAllListedProducts = function() {\n            ctrl.vm.allItemsSelected(false);\n            ctrl.vm.checkboxes(ctrl.vm.data().items.map(item => item._id));\n        };\n        ctrl.selectAllProducts = function() {\n            ctrl.selectAllListedProducts();\n            ctrl.vm.allItemsSelected(true);\n        };\n        ctrl.setPage = function(newPage) {\n            newPage = 0 | newPage;\n            if (isNaN(newPage) || newPage < 1) newPage = 1;\n            ctrl.vm.page(newPage);\n            ctrl.refresh();\n        };\n        ctrl.refresh = function() {\n            var url = ctrl.vm.url();\n            if (!url) return;\n            var data = {\n                sort: ctrl.vm.sort(),\n                perPage: 0 | ctrl.vm.perPage(),\n                page: 0 | ctrl.vm.page(),\n                filters: ctrl.vm.filterValues()\n            };\n            const params = m.route.parseQueryString(decodeURI(location.search));\n            params.jq = JSON.stringify(data);\n            m.request({\n                method: \"GET\",\n                url: url,\n                data: params\n            }).then(ctrl.vm.data, function() {\n                alert(\"An error occurred.\");\n            });\n            ctrl.saveSettings();\n        };\n        ctrl.saveSettings = function() {\n            if (!storage) return;\n            storage.setItem(\"picotablePerPage\", ctrl.vm.perPage());\n        };\n        ctrl.loadSettings = function() {\n            if (!storage) return;\n            var perPage = 0 | storage.getItem(\"picotablePerPage\");\n            if (perPage > 1) {\n                ctrl.vm.perPage(perPage);\n            }\n\n            // See if we're in pick mode...\n            var pickMatch = /pick=([^&]+)/.exec(location.search);\n            ctrl.vm.pickId(pickMatch ? pickMatch[1] : null);\n        };\n        ctrl.pickObject = function(object) {\n            var opener = window.opener;\n            if (!opener) {\n                alert(\"Window has no opener. Can't pick object.\");\n                return;\n            }\n            var text = null;  // Try to figure out a name for the object\n            Util.map([\"_text\", \"_name\", \"title\", \"name\", \"text\"], function(prop) {\n                if (!text && object[prop]) text = object[prop];\n            });\n            if (!text && object._abstract && object._abstract.length > 0) {\n                text = object._abstract[0];\n                if (text.text) text = text.text; // Unwrap possible abstract text\n            }\n            if (!text) text = \"#\" + object._id;\n            opener.postMessage({\n                \"pick\": {\n                    \"id\": ctrl.vm.pickId(),\n                    \"object\": {\n                        \"id\": object._id,\n                        \"text\": text,\n                        \"url\": object._url\n                    }\n                }\n            }, \"*\");\n            event.preventDefault();\n        };\n        ctrl.datePicker = function() {\n            return function(el, isInitialized) {\n                if(isInitialized) {\n                    return;\n                }\n\n                $(el).datetimepicker({\n                    format: \"yyyy-mm-dd\",\n                    autoclose: true,\n                    todayBtn: true,\n                    todayHighlight: true,\n                    fontAwesome: true,\n                    minView: 2\n                });\n            }\n        };\n        ctrl.loadSettings();\n        ctrl.adaptRenderMode();\n        window.addEventListener(\"resize\", Util.debounce(ctrl.adaptRenderMode, 100));\n\n        // Replace Mithril's deferred error monitor with one that can ignore JSON-parsing syntax errors.\n        // See https://lhorie.github.io/mithril/mithril.deferred.html#the-exception-monitor\n        m.deferred.onerror = function(e) {\n            if (e.toString().match(/^SyntaxError/)) return;\n\n            // Original onerror behavior below.\n            if ({}.toString.call(e) === \"[object Error]\" && !e.constructor.toString().match(/ Error/)) throw e;\n        };\n    }\n\n    var generator = function(container, dataSourceUrl) {\n        this.ctrl = m.mount(container, {view: PicotableView, controller: PicotableController});\n        this.ctrl.setSource(dataSourceUrl);\n    };\n    generator.lang = lang;\n    return generator;\n}(window.m, window.localStorage));\n/* eslint-disable */\nif (typeof module !== \"undefined\" && module !== null && module.exports) module.exports = Picotable;\nelse if (typeof define === \"function\" && define.amd) define(function() {\n    return Picotable;\n});\n"],"sourceRoot":"/source/"}