"use strict";var _slicedToArray=function(){function e(e,t){var a=[],i=!0,n=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(a.push(o.value),!t||a.length!==t);i=!0);}catch(c){n=!0,r=c}finally{try{!i&&s["return"]&&s["return"]()}finally{if(n)throw r}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();$(function(){function e(e,t){var a=e.attr("id"),i=$("#"+a+" .panel").length,n=$("#"+a+"-placeholder-panel"),r=$(n.html().replace(/__prefix__/g,i-1).replace(/__prefix_name__/g,i)),o="id_images";if(a.indexOf("media")>0&&(o="id_media"),t){var s=$("<a href='"+t.url+"' target='_blank'></a>");"id_images"===o?(s.append("<img src='"+t.url+"'>"),r.find(".thumbnail").append(s)):(s.append("<br><p>"+t.name+"</p>"),r.find(".thumbnail").append(s)),r.find(".file-control").find("input").val(t.id)}r.insertBefore(n)}function t(e,t){if(!(location.pathname.indexOf("new")>0)){for(var a=$("#product-"+t+"-section-dropzone").data().product_id,i=$("#product-"+t+"-section").find(".file-control input"),n=[],r=0;r<i.length;r++){var o=parseInt($(i[r]).val());isNaN(o)||n.push(parseInt($(i[r]).val()))}$.ajax({url:"/sa/products/"+a+"/media/add/",method:"POST",data:{csrfmiddlewaretoken:ShuupAdminConfig.csrf,product_id:a,file_ids:n,kind:t},traditional:!0,success:function(e){window.Messages.enqueue({tags:"success",text:e.message})},error:function(e){alert("ERROR")}})}}function a(t,a){a.xhr&&(a=JSON.parse(a.xhr.responseText).file),e(t,a)}$(".product-media-delete").on("click",function(e){e.preventDefault(),confirm(gettext("Are you sure you want to delete this media?"))&&($(this).parents(".panel").fadeOut(),$(this).next(".hide").find("input").prop("checked",!0))}),$(document).on("click",".set-as-primary",function(e){e.preventDefault();var t=$(this).parents(".panel"),a=t.data("prefix"),i=a.split("-"),n=_slicedToArray(i,2),r=n[1],o=$("#product-images-section .panel");o.removeClass("panel-selected").addClass("panel-default"),$(".is-primary-image").replaceWith(function(){return $("<a>",{"class":"set-as-primary",href:"#"}).text(gettext("Set as primary image"))}),o.each(function(e){$("#id_images-"+e+"-is_primary").prop("checked",!1)}),$(this).replaceWith(function(){return $("<span>",{"class":"is-primary-image"}).text(gettext("Primary image"))}),t.addClass("panel-selected"),$("#id_images-"+r+"-is_primary").prop("checked",!0)}),activateDropzone($("#product-images-section-dropzone"),{url:"/sa/media/?action=upload&path=/products/images",maxFiles:10,onSuccess:function(e){a($("#product-images-section"),e)},onQueueComplete:function(){t(this,"images")}}),activateDropzone($("#product-media-section-dropzone"),{url:"/sa/media/?action=upload&path=/products/media",maxFiles:10,onSuccess:function(e){a($("#product-media-section"),e)},onQueueComplete:function(){t(this,"media")}})});
//# sourceMappingURL=product.js.map
