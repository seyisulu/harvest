{"version":3,"sources":["base.js","form-utils.js","language-changer.js","select.js","drag-n-drop.js","dropzone.js","editor.js","materialize.js","main-menu.js","search.js","popover.js","tooltip.js","timesince.js","messages.js","browse-widget.js","side-nav.js","content-blocks.js","jquery.form-submission-attributes.polyfill.js","datetimepicker.js","tour.js","imagelightbox.js","slugify.js","quick_add_related_objects.js"],"names":["serializeForm","$form","arrayData","serializeArray","objectData","i","length","value","obj","name","$","isArray","push","renderFormErrors","errors","formName","formErrors","fieldName","fieldErrors","join","parent","find","append","$field","addClass","clearErrors","removeClass","remove","empty","changeLanguage","form","document","createElement","method","action","window","ShuupAdminConfig","browserUrls","setLanguage","input","type","id","this","data","appendChild","body","submit","activateSelect","$select","model","attrs","arguments","undefined","select2","extend","language","minimumInputLength","ajax","url","dataType","params","search","term","processResults","results","map","item","text","activateSelects","each","idx","object","select","hasClass","updateOrdering","e","items","targetElement","elem","attr","removeFromActive","preventDefault","label","$source","html","replace","sourceElement","closest","addToActive","activateDropzone","$dropzone","selector","uploadPath","upload_path","addRemoveLinks","add_remove_links","csrfmiddlewaretoken","csrf","dictRemoveFile","gettext","autoProcessQueue","uploadMultiple","parallelUploads","maxFiles","dictDefaultMessage","clickable","accept","file","done","kind","indexOf","dropzone","Dropzone","on","onAddedFile","files","removeFile","onSuccess","val","xhr","JSON","parse","responseText","onQueueComplete","noop","BrowseAPI","openBrowseWindow","disabledMenus","filter","onSelect","emit","thumbnail","activateDropzones","includes","activateEditor","$editor","summernote","height","callbacks","onBlur","activateEditors","materialize","mithrilElement","root","_materializeRoot","createDocumentFragment","m","render","firstChild","openMainNav","closeMainNav","mainNavIsOpen","closeAllSubmenus","click","event","stopPropagation","target_id","$target","isOpen","toggleClass","target","onresize","width","Masonry","itemSelector","columnWidth","percentPosition","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","err","Array","Object","TypeError","getShortcutFinder","usedShortcuts","s","firstChoices","lastChoices","keys","toLowerCase","split","key","_","detect","possibleKey","resultView","ctrl","showShortcuts","_$partition","partition","_$partition2","actionResults","standardResults","getShortcut","singleResultLi","result","linkClass","href","accesskey","icon","toUpperCase","standardResultContents","groupBy","groupResults","category","actionResultContents","searchCtrl","prop","doSearch","query","searchUrl","q","redraw","setShowShortcuts","keyCode","addEventListener","closeMobileSearchResults","windowWidth","outerWidth","$siteSearchResults","is","slideUp","searchResultController","container","getElementById","mount","controller","view","doSearchDebounced","debounce","resize","$searchInputs","slideDown","popover","tooltip","delay","show","hide","update","$el","ts","time","moment","isValid","fromNow","setInterval","Messages","createContainer","hideOnClickOut","classList","add","setTimeout","clear","removeChild","node","parentNode","renderMessage","message","messageDiv","tags","isString","className","textSpan","textNode","createTextNode","flush","queue","shift","defer","enqueue","deferredFlush","options","browserUrl","Error","stringify","Date","qs","compact","popup","open","browseData","$container","pick","info","close","isFunction","call","$text","alert","emptyText","test","getSectionNavigatorModule","$navigateeForm","$sections","navigationListItems","section","$section","$blockTitle","titleText","kebabCase","el","title","iconClass","errorClass","currentId","currentItemId","classes","onclick","showSection","$visibleSection","activateSectionNavigation","$sectionNavigation","navigateeId","location","hash","trigger","$contentBlocks","$contentWraps","$collapseElement","collapse","first","css","ready","setNextActionAndSubmit","formId","nextAction","$nextAction","$ctr","firstTabWithErrorsOpened","$tab","lang","$tabPane","tabHasErrors","$tabLink","tab","allowedButtons","formAttributes","fn","formSubmissionAttributes","$inputs","buttons","$this","navigator","userAgent","match","$f","jQuery","datetimepicker","format","autoclose","todayBtn","todayHighlight","fontAwesome","minView","amd","define","errorLoading","inputTooLong","args","overChars","maximum","ngettext","interpolate","inputTooShort","remainingChars","minimum","loadingMore","maximumSelected","noResults","searching","getAppChromeSteps","position","left","steps","concat","attachTo","tour","config","getTextLines","content","getHelpButton","page","helpUrl","getTourButtons","back","cancel","pageSteps","Shepherd","Tour","defaults","scrollTo","showCancelLink","tourKey","step","buttonType","helpPage","banner","addStep","post","start","imageLightbox","button","overlay","activateSortable","Sortable","create","handle","onEnd","evt","slugify","toString","autoSlugify","autoDiscover","addToSelect2","newOption","Option","categories","_newOption","closeQuickAddIFrame","contentPane","closeIcon","closeButton","iframe","frameBorder","onload","setAttribute"],"mappings":"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","file":"base.js","sourcesContent":["/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n/**\n * Materialize a Mithril.js virtual tree into a DOM node.\n * @param mithrilElement The virtual tree's root (a retval of `m()`)\n * @returns {Node} The materialized root of the virtual tree\n */\n\"use strict\";\n\nwindow.materialize = function materialize(mithrilElement) {\n  // Cache a document fragment for materialization\n  var root = window._materializeRoot || (window._materializeRoot = document.createDocumentFragment());\n\n  // Render something into that root\n  m.render(root, mithrilElement, true);\n\n  // Then return the first child\n  return root.firstChild;\n};\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\n$(function () {\n    \"use strict\";\n\n    function openMainNav() {\n        $(document.body).addClass(\"menu-open\");\n    }\n\n    function closeMainNav() {\n        $(document.body).removeClass(\"menu-open\");\n    }\n\n    function mainNavIsOpen() {\n        return $(document.body).hasClass(\"menu-open\");\n    }\n\n    $(\"#menu-button\").click(function (event) {\n        closeAllSubmenus();\n        $(\"#site-search.mobile\").removeClass(\"open\"); // Close search if open on mobile\n        event.stopPropagation();\n        if (mainNavIsOpen()) {\n            closeMainNav();\n        } else {\n            openMainNav();\n        }\n    });\n\n    function closeAllSubmenus() {\n        $(\".category-submenu\").each(function (idx, elem) {\n            $(elem).removeClass(\"open\");\n        });\n    }\n    $(document).on(\"click\", \"#main-menu ul.menu-list > li a\", function (e) {\n        e.preventDefault();\n        e.stopPropagation(); // do not close submenus\n        var target_id = $(this).data(\"target-id\");\n        $(\".category-submenu\").each(function (idx, elem) {\n            if ($(elem).attr(\"id\") != target_id) {\n                $(elem).removeClass(\"open\");\n            }\n        });\n        var $target = $(\"#\" + target_id);\n        if (!$target.length) {\n            return;\n        }\n        var isOpen = $target.hasClass(\"open\");\n        $target.toggleClass(\"open\", !isOpen);\n    });\n\n    $(window).click(function () {\n        closeAllSubmenus();\n    });\n\n    $('.category-submenu').click(function (event) {\n        event.stopPropagation();\n        if ($(event.target).hasClass(\"fa-close\")) {\n            closeAllSubmenus();\n        }\n    });\n\n    window.onresize = function () {\n        closeAllSubmenus();\n        if ($(window).width() < 768) {\n            closeMainNav();\n        }\n    };\n    if (window.Masonry) {\n        (function () {\n            var Masonry = window.Masonry;\n            $(\".category-menu-content\").each(function (idx, elem) {\n                var msnry = new Masonry(elem, {\n                    itemSelector: '.submenu-container',\n                    columnWidth: '.submenu-container',\n                    percentPosition: true\n                });\n            });\n        })();\n    }\n});\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\nvar _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; })();\n\n$(function () {\n    \"use strict\";\n    var searchResultController = null;\n\n    function getShortcutFinder() {\n        var usedShortcuts = { \"s\": true };\n        var firstChoices = \"123456789\";\n        var lastChoices = \"abcdefghijklmnopqrstuvwxyz\";\n        return function (text) {\n            var keys = (firstChoices + text.toLowerCase().replace(/[^a-z0-9]+/g, \"\") + lastChoices).split(\"\");\n            var key = _.detect(keys, function (possibleKey) {\n                return !usedShortcuts[possibleKey];\n            });\n            if (key !== null) {\n                usedShortcuts[key] = true;\n            }\n            return key;\n        };\n    }\n\n    function resultView(ctrl) {\n        var results = ctrl.results();\n        if (results !== null && results.length === 0) {\n            return m(\"div\", gettext(\"No results.\"));\n        }\n        var showShortcuts = !!ctrl.showShortcuts();\n\n        var _$partition = _.partition(results, \"isAction\");\n\n        var _$partition2 = _slicedToArray(_$partition, 2);\n\n        var actionResults = _$partition2[0];\n        var standardResults = _$partition2[1];\n\n        var getShortcut = getShortcutFinder();\n\n        var singleResultLi = function singleResultLi(result, linkClass) {\n            var key = showShortcuts ? getShortcut(result.text) : null;\n            var attrs = { href: result.url, accesskey: key };\n            if (result.target) {\n                attrs[\"target\"] = result.target;\n            }\n            return m(\"li\", { key: result.url }, m(linkClass, attrs, [result.icon ? m(\"i.\" + result.icon) : null, result.text, key ? m(\"span.key\", key.toUpperCase()) : null]));\n        };\n\n        var standardResultContents = m(\"div\", _(standardResults).groupBy(\"category\").map(function (groupResults, category) {\n            return m(\"div.result-category\", [m(\"h3.divider\", [\"\" + category]), m(\"ul\", _.map(groupResults, function (result) {\n                return singleResultLi(result, \"a.result\");\n            }))]);\n        }).value());\n\n        var actionResultContents = m(\"div\", m(\"ul\", _.map(actionResults, function (result) {\n            return singleResultLi(result, \"a.btn.btn-gray\");\n        })));\n\n        return m(\"div.container-fluid\", m(\"div.results\", { id: \"site-search-standard-results\" }, standardResultContents), m(\"div.additional\", { id: \"site-search-action-results\" }, actionResultContents));\n    }\n\n    function searchCtrl() {\n        var ctrl = this;\n        ctrl.results = m.prop(null);\n        ctrl.showShortcuts = m.prop(false);\n        this.doSearch = function (query) {\n            if (!query) {\n                ctrl.results([]);\n                m.redraw();\n                return;\n            }\n            $.ajax({\n                url: window.ShuupAdminConfig.searchUrl,\n                data: { \"q\": query }\n            }).done(function (data) {\n                ctrl.results(data.results);\n                m.redraw();\n            });\n        };\n        var setShowShortcuts = function setShowShortcuts(event) {\n            if (event.keyCode === 18) {\n                // 18 = alt\n                ctrl.showShortcuts(event.type === \"keydown\");\n                m.redraw();\n            }\n        };\n        document.addEventListener(\"keydown\", setShowShortcuts, false);\n        document.addEventListener(\"keyup\", setShowShortcuts, false);\n    }\n\n    var doSearch = function doSearch(query) {\n        if (!searchResultController) {\n            var container = document.getElementById(\"site-search-results\");\n            searchResultController = m.mount(container, { controller: searchCtrl, view: resultView });\n        }\n        searchResultController.doSearch(query);\n    };\n\n    var doSearchDebounced = _.debounce(doSearch, 500);\n\n    $(document).click(function (e) {\n        if (!$(e.target).closest(\"#site-search\").length) {\n            $(\"#site-search-results\").slideUp(400, \"easeOutCubic\");\n        }\n    });\n\n    // Disable default behaviour on mobile for the search dropdown.\n    // The dropdown now stays open if clicked into the input field\n    $(\".mobile-search-dropdown\").click(function (e) {\n        e.stopPropagation();\n    });\n\n    // Hide search results if results are open and search parent element is clicked\n    $(\"#site-search\").find(\".mobile\").click(function () {\n        if ($(this).hasClass(\"open\")) {\n            $(\"#site-search-results\").slideUp(400, \"easeOutCubic\");\n        }\n    });\n\n    function closeMobileSearchResults() {\n        var windowWidth = $(window).outerWidth(true);\n        var $siteSearchResults = $(\"#site-search-results\");\n        if ($siteSearchResults.is(\":visible\") && windowWidth < 768) {\n            $siteSearchResults.slideUp(400, \"easeOutCubic\");\n        }\n    }\n\n    $(window).resize(_.debounce(closeMobileSearchResults, 100));\n\n    var $searchInputs = $(\"#site-search-input, #site-search-input-mobile\");\n\n    $searchInputs.on(\"keyup\", function () {\n        var query = $(this).val();\n        if (query.length > 0) {\n            $(\"#site-search-results\").slideDown(300, \"easeInSine\");\n            doSearchDebounced(query);\n        } else {\n            $(\"#site-search-results\").slideUp(400, \"easeOutSine\");\n        }\n    });\n    $searchInputs.on(\"focus\", function () {\n        if ($(this).val().length > 0) {\n            $(\"#site-search-results\").slideDown(300, \"easeInSine\");\n        }\n    });\n});\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\n$((function () {\n  \"use strict\";\n  $(\"[data-toggle='popover']\").popover();\n})());\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\n$((function () {\n    \"use strict\";\n    $(\"[data-toggle=\\\"tooltip\\\"]\").tooltip({\n        delay: { \"show\": 750, \"hide\": 100 }\n    });\n    $(\"#dropdownMenu\").tooltip({\n        delay: { \"show\": 750, \"hide\": 100 }\n    });\n})());\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\n$(function () {\n    \"use strict\";\n    function update() {\n        $(\".timesince\").each(function () {\n            var $el = $(this);\n            var ts = $el.data(\"ts\");\n            if (!ts) {\n                return;\n            }\n            var time = moment(ts);\n            if (!time.isValid()) {\n                return;\n            }\n            $el.text(time.fromNow());\n        });\n    }\n    update();\n    setInterval(update, 60000);\n});\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\nwindow.Messages = (function Messages(document) {\n    var queue = [];\n    var container = null;\n    function createContainer() {\n        if (!container) {\n            container = document.createElement(\"div\");\n            container.id = \"message-container\";\n            document.body.appendChild(container);\n            document.addEventListener(\"click\", hideOnClickOut, false);\n        }\n    }\n    function show() {\n        if (container) {\n            container.classList.remove(\"clear\");\n            container.classList.add(\"visible\");\n        }\n    }\n    function hide() {\n        if (container) {\n            container.classList.remove(\"visible\");\n            container.classList.add(\"clear\");\n            setTimeout(clear, 2000);\n        }\n    }\n    function clear() {\n        container.classList.remove(\"clear\");\n        while (container && container.firstChild) {\n            container.removeChild(container.firstChild);\n        }\n    }\n    function hideOnClickOut(event) {\n        var node = event.target;\n        while (node) {\n            if (node.id === \"message-container\") {\n                return;\n            }\n            node = node.parentNode;\n        }\n        hide();\n    }\n    function renderMessage(message) {\n        var messageDiv = document.createElement(\"div\");\n        var tags = message.tags || [];\n        if (_.isString(tags)) {\n            tags = tags.split(\" \");\n        }\n        messageDiv.className = \"message \" + tags.join(\" \");\n        var textSpan = document.createElement(\"span\");\n        var textNode = document.createTextNode(message.text || \"no text\");\n        textSpan.appendChild(textNode);\n        messageDiv.appendChild(textSpan);\n        return messageDiv;\n    }\n    function flush() {\n        if (!queue.length) {\n            return;\n        }\n        if (!document.body) {\n            // Try again soon\n            return setTimeout(flush, 50);\n        }\n        createContainer();\n        while (queue.length > 0) {\n            container.appendChild(renderMessage(queue.shift()));\n        }\n        _.defer(show);\n    }\n    var deferredFlush = _.debounce(flush, 50);\n    function enqueue(message) {\n        queue.push(message);\n        deferredFlush();\n    }\n\n    return {\n        enqueue: enqueue,\n        hide: hide\n    };\n})(window.document);\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n/**\n * Support for media browsing widgets.\n * Currently opens a real, actual, true-to-1998\n * popup window (just like the Django admin, mind)\n * but could just as well use an <iframe> modal.\n */\n\n\"use strict\";\n\nwindow.BrowseAPI = (function () {\n    var browseData = {};\n\n    window.addEventListener(\"message\", function (event) {\n        var data = event.data;\n        if (!data.pick) {\n            return;\n        }\n        var info = browseData[data.pick.id];\n        if (!info) {\n            return;\n        }\n        info.popup.close();\n        var obj = data.pick.object;\n        if (!obj) {\n            return;\n        }\n        if (_.isFunction(info.onSelect)) {\n            info.onSelect.call(this, obj);\n        }\n        delete browseData[data.pick.id];\n    }, false);\n\n    /**\n     * Open a browsing window with the given options.\n     *\n     * Currently supported options are:\n     * * `kind`: kind string (e.g. \"product\")\n     * * `filter`: filter string (kind-dependent)\n     * * `onSelect`: a function invoked when an object is selected\n     * @return {Object}\n     */\n    function openBrowseWindow(options) {\n        var filter = options.filter;\n        var disabledMenus = options.disabledMenus;\n        var kind = options.kind;\n        var browserUrl = window.ShuupAdminConfig.browserUrls[kind];\n        if (!browserUrl) {\n            throw new Error(gettext(\"No browser URL for kind:\") + \" \" + kind);\n        }\n        if (typeof filter !== \"string\") {\n            filter = JSON.stringify(filter);\n        }\n        var id = \"m-\" + +new Date();\n        var qs = _.compact([\"popup=1\", \"pick=\" + id, filter ? \"filter=\" + filter : null, disabledMenus ? \"disabledMenus=\" + disabledMenus.join(\",\") : null]).join(\"&\");\n        var popup = window.open(browserUrl + (browserUrl.indexOf(\"?\") > -1 ? \"&\" : \"?\") + qs, \"browser_popup_\" + id, \"resizable,menubar=no,location=no,scrollbars=yes\");\n        return browseData[id] = _.extend({ popup: popup, $container: null, onSelect: null }, options);\n    }\n\n    return {\n        openBrowseWindow: openBrowseWindow\n    };\n})();\n\n$(function () {\n    $(document).on(\"click\", \".browse-widget .browse-btn\", function () {\n        var $container = $(this).closest(\".browse-widget\");\n        if (!$container.length) {\n            return;\n        }\n        var kind = $container.data(\"browse-kind\");\n        var filter = $container.data(\"filter\");\n        try {\n            return window.BrowseAPI.openBrowseWindow({ kind: kind, filter: filter, onSelect: function onSelect(obj) {\n                    $container.find(\"input\").val(obj.id);\n                    var $text = $container.find(\".browse-text\");\n                    $text.text(obj.text);\n                    $text.prop(\"href\", obj.url || \"#\");\n                } });\n        } catch (e) {\n            alert(e);\n            return false;\n        }\n    });\n\n    $(document).on(\"click\", \".browse-widget .clear-btn\", function () {\n        var $container = $(this).closest(\".browse-widget\");\n        if (!$container.length) {\n            return;\n        }\n        var emptyText = $container.data(\"empty-text\") || \"\";\n        $container.find(\"input\").val(\"\");\n        var $text = $container.find(\".browse-text\");\n        $text.text(emptyText);\n        $text.prop(\"href\", \"#\");\n    });\n\n    $(document).on(\"click\", \".browse-widget .browse-text\", function (event) {\n        var href = $(this).prop(\"href\");\n        if (/#$/.test(href)) {\n            // Looks empty, so prevent clicks\n            event.preventDefault();\n            return false;\n        }\n    });\n});\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\n$(function () {\n    \"use strict\";\n    /**\n     * Return a Mithril module to create a navigator for the given navigatee form (jQuery object)\n     */\n    function getSectionNavigatorModule($navigateeForm) {\n        var $sections = $navigateeForm.find(\".content-block\");\n\n        var navigationListItems = _.compact(_.map($sections, function (section) {\n            var $section = $(section);\n            var $blockTitle = $section.find(\".block-title\");\n            var titleText = $blockTitle.text();\n            if (!titleText) {\n                return;\n            }\n            if (!section.id) {\n                section.id = _.kebabCase(titleText) + \"-section\";\n            }\n\n            return {\n                el: section,\n                id: section.id,\n                title: titleText,\n                iconClass: $blockTitle.find(\".fa\").attr(\"class\"),\n                errorClass: $section.find(\".has-error\").length ? \"normal\" : null\n            };\n        }));\n\n        if (!navigationListItems.length) {\n            return null;\n        }\n\n        return {\n            view: function view(ctrl) {\n                var currentId = ctrl.currentItemId();\n                return m(\"div.sidebar-list\", ctrl.navigationListItems().map(function (item) {\n                    var classes = (item.id === currentId ? \".active\" : \"\") + (item.errorClass ? \".errors\" : \"\");\n                    return m(\"a.sidebar-list-item\" + classes, {\n                        key: item.id,\n                        href: \"#\" + item.id,\n                        onclick: function onclick() {\n                            ctrl.showSection(item);\n                            return false;\n                        }\n                    }, [item.iconClass ? m(\"i\", { className: item.iconClass }) : null, item.title, item.errorClass ? m(\"div.error-indicator.\" + item.errorClass, m(\"i.fa.fa-exclamation-circle\")) : null]);\n                }));\n            },\n            controller: function controller() {\n                var ctrl = this;\n                ctrl.showSection = function (section) {\n                    $sections.hide();\n                    if (section.errorClass) {\n                        section.errorClass = \"dismissed\";\n                    }\n                    var $visibleSection = $(\"#\" + section.id);\n                    $visibleSection.show();\n                    ctrl.currentItemId(section.id);\n                };\n                ctrl.currentItemId = m.prop(null);\n                ctrl.navigationListItems = m.prop(navigationListItems);\n                ctrl.showSection(navigationListItems[0]);\n            }\n        };\n    }\n    function activateSectionNavigation($sectionNavigation) {\n        if (!$sectionNavigation.length) {\n            return;\n        }\n        var navigateeId = $sectionNavigation.data(\"navigatee\");\n        var $navigateeForm = $(\"#\" + navigateeId);\n        if (!$navigateeForm.length) {\n            return;\n        }\n        m.mount($sectionNavigation[0], getSectionNavigatorModule($navigateeForm));\n    }\n    $(\".section-navigation, #section-navigation\").each(function () {\n        activateSectionNavigation($(this));\n    });\n\n    if (location.hash) {\n        var $section = $(\"a[href='\" + location.hash + \"']\");\n        if ($section.length) {\n            $section.trigger(\"click\");\n        } else {\n            location.hash = \"\";\n        }\n    }\n});\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\n$(function () {\n    var $contentBlocks = $(\".content-block\");\n    var $contentWraps = $contentBlocks.find(\".content-wrap\");\n\n    $(\".toggle-contents\").click(function (event) {\n        var $collapseElement = $(this).closest(\".content-block\").find(\".content-wrap\");\n        event.preventDefault();\n\n        // Checks if the bootstrap collapse animation is not ongoing\n        if (!$collapseElement.hasClass(\"collapsing\")) {\n            $collapseElement.collapse(\"toggle\");\n            $(this).closest(\".title\").toggleClass(\"open\");\n        }\n    });\n    $contentBlocks.each(function () {\n        if ($(this).find(\".has-error\").length) {\n            $(this).find(\".block-title\").addClass(\"mobile-error-indicator\");\n        }\n    });\n\n    // Activate first sidebar-list-item with errors\n    $(\"a.sidebar-list-item.errors\").first().trigger(\"click\");\n\n    // clear inline height: 0 on resize since we want blocks to be expanded on medium screens\n    // this circumvents the need for !important in our css\n    $(window).resize(_.debounce(function () {\n        $contentWraps.css(\"height\", \"\");\n        $(\"#main-content\").css(\"margin-top\", $(\".support-nav-wrap\").height() + 15);\n    }, 100));\n\n    $(window).ready(function () {\n        $(\"#main-content\").css(\"margin-top\", $(\".support-nav-wrap\").height() + 15);\n    });\n});\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\n\nwindow.setNextActionAndSubmit = function (formId, nextAction) {\n    var $form = $(\"#\" + formId);\n    if (!$form.length) {\n        return;\n    }\n    var $nextAction = $form.find(\"input[name=__next]\");\n    if (!$nextAction.length) {\n        $nextAction = $(\"<input>\", {\n            type: \"hidden\",\n            name: \"__next\"\n        });\n        $form.append($nextAction);\n    }\n    $nextAction.val(nextAction);\n    $form.submit();\n};\n\nfunction serializeForm($form) {\n    var arrayData = $form.serializeArray();\n    var objectData = {};\n    for (var i = 0; i < arrayData.length; i++) {\n        var obj = arrayData[i];\n        var value;\n        if (obj.value !== null) {\n            value = obj.value;\n        } else {\n            value = \"\";\n        }\n\n        if (typeof objectData[obj.name] !== \"undefined\") {\n            if (!$.isArray(objectData[obj.name])) {\n                objectData[obj.name] = [objectData[obj.name]];\n            }\n            objectData[obj.name].push(value);\n        } else {\n            objectData[obj.name] = value;\n        }\n    }\n    return objectData;\n}\n\nfunction renderFormErrors($form, errors) {\n    for (var formName in errors) {\n        var formErrors = errors[formName];\n        for (var fieldName in formErrors) {\n            var fieldErrors = formErrors[fieldName].join(\" \");\n            if (fieldName === \"__all__\") {\n                $form.parent().find(\".errors\").append('<div class=\"alert alert-danger\">' + fieldErrors + '</div>');\n            } else {\n                var $field = $form.find(\":input[name='\" + formName + \"-\" + fieldName + \"']\").parent(\".form-group\");\n                $field.append(\"<span class='help-block error-block'>\" + fieldErrors + \"</span>\").addClass(\"has-error\");\n            }\n        }\n    }\n}\n\nfunction clearErrors($form) {\n    $form.find(\".has-error\").removeClass(\"has-error\");\n    $form.find(\".error-block\").remove();\n    $form.parent().find(\".errors\").empty();\n}\n\n$((function () {\n    $(\".language-dependent-content\").each(function () {\n        var $ctr = $(this);\n        var firstTabWithErrorsOpened = false;\n        $ctr.find(\".nav-tabs li\").each(function () {\n            var $tab = $(this);\n            var lang = $tab.data(\"lang\");\n            if (!lang) {\n                return;\n            }\n            var $tabPane = $ctr.find(\".tab-pane[data-lang=\" + lang + \"]\");\n            if (!$tabPane) {\n                return;\n            }\n            var tabHasErrors = $tabPane.find(\".has-error\").length > 0;\n            if (tabHasErrors) {\n                var $tabLink = $tab.find(\"a\");\n                $tabLink.append($(\" <div class=error-indicator><i class=\\\"fa fa-exclamation-circle\\\"></i></div>\"));\n                if (!firstTabWithErrorsOpened) {\n                    $tabLink.tab(\"show\");\n                    firstTabWithErrorsOpened = true;\n                }\n            }\n        });\n    });\n})());\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\n(function ($) {\n    \"use strict\";\n\n    var allowedButtons = \"input[type=\\\"submit\\\"], input[type=\\\"image\\\"], button:not([type]), button[type=\\\"submit\\\"]\";\n    var formAttributes = [\"action\", \"method\", \"enctype\", \"target\", \"novalidate\"];\n\n    $.fn.formSubmissionAttributes = function () {\n        //based on https://github.com/mattberkowitz/Form-Submission-Attributes-Polyfill\n\n        this.each(function () {\n            var $form = $(this);\n            var $inputs = $form.find(allowedButtons);\n            var formId = $form.attr(\"id\");\n\n            if (formId) {\n                // find buttons that are tied to this form and add them to $inputs\n                var buttons = $(\"input[form=\\\"\" + formId + \"\\\"],button[form=\\\"\" + formId + \"\\\"]\");\n                buttons = buttons.filter(allowedButtons);\n                $inputs = $inputs.add(buttons);\n            }\n\n            //backup originals\n            $.each(formAttributes, function (idx, attr) {\n                $form.data(\"o\" + attr, $form.attr(attr));\n            });\n\n            $inputs.on(\"click\", function () {\n                var $this = $(this);\n                $.each(formAttributes, function (idx, attr) {\n                    var value = $this.is(\"[form\" + attr + \"]\") ? $this.attr(\"form\" + attr) : $form.data(\"o\" + attr);\n                    $form.attr(attr, value);\n                });\n            });\n        });\n    };\n\n    if (window.navigator.userAgent.indexOf(\"MSIE \") > 0 || !!navigator.userAgent.match(/Trident.*rv\\:11\\./)) {\n        $(document).on(\"click\", \"[type=submit][form]\", function (event) {\n            event.preventDefault();\n            var formId = $(this).attr(\"form\");\n            var $f = $(\"#\" + formId);\n            $f.formSubmissionAttributes();\n            $f.submit();\n        });\n    }\n})(jQuery);\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\n$(function () {\n    $(\".form-control.datetime\").datetimepicker({\n        format: \"yyyy-mm-dd hh:ii\",\n        autoclose: true,\n        todayBtn: true,\n        todayHighlight: true,\n        fontAwesome: true\n    });\n    $(\".form-control.date\").datetimepicker({\n        format: \"yyyy-mm-dd\",\n        autoclose: true,\n        todayBtn: true,\n        todayHighlight: true,\n        fontAwesome: true,\n        minView: 2\n    });\n});\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\nfunction changeLanguage() {\n    var form = document.createElement(\"form\");\n    form.method = \"POST\";\n    form.action = window.ShuupAdminConfig.browserUrls.setLanguage;\n    var input = document.createElement(\"input\");\n    input.type = \"hidden\";\n    input.name = \"language\";\n    input.id = \"language-field\";\n    input.value = $(this).data(\"value\");\n    form.appendChild(input);\n    document.body.appendChild(form);\n    form.submit();\n}\n\n$(function () {\n    \"use strict\";\n    $(\".languages li a\").click(changeLanguage);\n});\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\n\nfunction activateSelect($select, model) {\n    var attrs = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\n    if (model === undefined) {\n        return $select.select2($.extend(true, {\n            language: \"xx\"\n        }, attrs));\n    }\n    return $select.select2($.extend(true, {\n        language: \"xx\",\n        minimumInputLength: 3,\n        ajax: {\n            url: \"/sa/select\",\n            dataType: \"json\",\n            data: function data(params) {\n                return { model: model, search: params.term };\n            },\n            processResults: function processResults(data) {\n                return {\n                    results: $.map(data.results, function (item) {\n                        return { text: item.name, id: item.id };\n                    })\n                };\n            }\n        }\n    }, attrs));\n}\n\nfunction activateSelects() {\n    $(\"select\").each(function (idx, object) {\n        var select = $(object);\n        // only activate selects that aren't already select2 inputs\n        if (!select.hasClass(\"select2-hidden-accessible\") && !select.hasClass(\"no-select2\")) {\n            var model = select.data(\"model\");\n            activateSelect(select, model);\n        }\n    });\n}\n\n$(function () {\n    // Handle localization with Django instead of using select2 localization files\n    $.fn.select2.amd.define(\"select2/i18n/xx\", [], function () {\n        return {\n            errorLoading: function errorLoading() {\n                return gettext(\"The results could not be loaded\");\n            },\n            inputTooLong: function inputTooLong(args) {\n                var overChars = args.input.length - args.maximum;\n                var message = ngettext(\"Please delete %s character\", \"Please delete %s characters\", overChars);\n                return interpolate(message, [overChars]);\n            },\n            inputTooShort: function inputTooShort(args) {\n                var remainingChars = args.minimum - args.input.length;\n                return interpolate(gettext(\"Please enter %s or more characters\"), [remainingChars]);\n            },\n            loadingMore: function loadingMore() {\n                return gettext(\"Loading more results...\");\n            },\n            maximumSelected: function maximumSelected(args) {\n                var message = ngettext(\"You can only select %s item\", \"You can only select %s items\", args.maximum);\n                return interpolate(message, [args.maximum]);\n            },\n            noResults: function noResults() {\n                return gettext(\"No results found\");\n            },\n            searching: function searching() {\n                return gettext(\"Searching...\");\n            }\n        };\n    });\n\n    activateSelects();\n});\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\n(function ($) {\n    function getAppChromeSteps(key) {\n        if (key !== \"home\" && typeof key !== \"undefined\") {\n            return [];\n        }\n        if ($(\"#main-menu\").position().left !== 0) {\n            // don't show chrome tour on mobile\n            return [];\n        }\n        var steps = [];\n        steps = steps.concat([{\n            title: gettext(\"Quick Links\"),\n            text: [gettext(\"Quick Links to your most used features.\")],\n            attachTo: \"li a[data-target-id='quicklinks'] right\"\n        }, {\n            title: gettext(\"Orders\"),\n            text: [gettext(\"Track and filter your customers orders here.\")],\n            attachTo: \"li a[data-target-id='category-1'] right\"\n        }, {\n            title: gettext(\"Products\"),\n            text: [gettext(\"All your exciting products and features are located here.\")],\n            attachTo: \"li a[data-target-id='category-2'] right\"\n        }, {\n            title: gettext(\"Contacts\"),\n            text: [gettext(\"All your customer data is located here. Target and organize your clients details your way!\")],\n            attachTo: \"li a[data-target-id='category-3'] right\"\n        }]);\n\n        if ($(\"li a[data-target-id='category-5']\").length > 0) {\n            steps.push({\n                title: gettext(\"Campaigns\"),\n                text: [gettext(\"Great loyalty tool for creating marketing, campaigns, special offers and coupons to entice your shoppers!\"), gettext(\"Set offers based on their previous purchase behavior to up- and cross sale your inventory.\")],\n                attachTo: \"li a[data-target-id='category-5'] right\"\n            });\n        }\n\n        if ($(\"li a[data-target-id='category-9']\").length > 0) {\n            steps.push({\n                title: gettext(\"Content\"),\n                text: [gettext(\"The make-over tool to customize you site themes, add pages and product carousels. Incorporate any media to make your store pop!\")],\n                attachTo: \"li a[data-target-id='category-9'] right\"\n            });\n        }\n\n        if ($(\"li a[data-target-id='category-4']\").length > 0) {\n            steps.push({\n                title: gettext(\"Reports\"),\n                text: [gettext(\"Your reporting tool to build and analyze your consumer behavior information that can assist with your business decisions.\")],\n                attachTo: \"li a[data-target-id='category-4'] right\"\n            });\n        }\n\n        steps.push({\n            title: gettext(\"Shops\"),\n            text: [gettext(\"Place for your Shop specific settings. You can customize taxes, currencies, customer groups, and many other things in this menu.\")],\n            attachTo: \"li a[data-target-id='category-6'] right\"\n        });\n\n        if ($(\"li a[data-target-id='category-7']\").length > 0) {\n            steps.push({\n                title: gettext(\"Addons\"),\n                text: [gettext(\"This is your connection interface. Addons and other systems you use can be attached to your store through powerful data connections.\"), gettext(\"Supercharge your site and gather crazy amounts of data with integrations to CRMs and ERPs, POSs and PIMs, or any other acronym you can think of.\")],\n                attachTo: \"li a[data-target-id='category-7'] right\"\n            });\n        }\n\n        steps = steps.concat([{\n            title: gettext(\"Settings\"),\n            text: [gettext(\"The nuts and bolts of your store are found here. From individual country tax-regulations to your contact details.\")],\n            attachTo: \"li a[data-target-id='category-8'] right\"\n        }, {\n            title: gettext(\"Search\"),\n            text: [gettext(\"Lost and cannot find your way? No worries, you can search contacts, settings, add-ons and more features from here.\")],\n            attachTo: \"#site-search bottom\"\n        }, {\n            title: gettext(\"View your storefront\"),\n            text: [gettext(\"Preview your shop and all the cool features you have created!\")],\n            attachTo: \".shop-btn.visit-store left\"\n        }, {\n            title: gettext(\"We're done!\"),\n            text: [gettext(\"It was nice to show you around!\"), gettext(\"If you need to run it again, fire it up from the menu in the top right.\")]\n        }]);\n        return steps;\n    }\n\n    $(document).ready(function () {\n        $(\"#top-header .show-tour-li\").on(\"click\", \"a\", function (e) {\n            e.preventDefault();\n            $.tour();\n        });\n    });\n\n    $.tour = function (config, params) {\n        if (config === undefined) config = {};\n\n        if (config === \"setPageSteps\") {\n            this.pageSteps = params;\n            return;\n        }\n        var tour = new Shepherd.Tour({\n            defaults: {\n                classes: \"shepherd-theme-arrows\",\n                scrollTo: true,\n                showCancelLink: true\n            }\n        });\n\n        var steps = [];\n        if (this.pageSteps && this.pageSteps.length > 1) {\n            steps = this.pageSteps;\n        } else {\n            steps = (this.pageSteps || []).concat(getAppChromeSteps(config.tourKey));\n        }\n\n        $.each(steps, function (idx, step) {\n            var buttonType = null;\n            if (idx === 0) {\n                buttonType = \"first\";\n            }\n            if (idx === steps.length - 1) {\n                buttonType = \"last\";\n            }\n            step = $.extend({}, step, { buttons: getTourButtons(buttonType) });\n            var content = \"\";\n            if (step.icon) {\n                content += \"<div class='clearfix'>\";\n                content += \"<div class='pull-left'>\";\n                content += \"<div class='icon'>\";\n                content += \"<img src='\" + step.icon + \"' />\";\n                content += \"</div>\";\n                content += \"</div>\";\n                content += \"<div class='step-with-icon'>\";\n                content += getTextLines(step.text);\n                content += getHelpButton(step.helpPage);\n                content += \"</div>\";\n                content += \"</div>\";\n            } else if (step.banner) {\n                content += \"<div>\";\n                content += \"<div class='banner'>\";\n                content += \"<img src='\" + step.banner + \"' />\";\n                content += \"</div>\";\n                content += \"<div class='step-with-banner'>\";\n                content += getTextLines(step.text);\n                content += getHelpButton(step.helpPage);\n                content += \"</div>\";\n                content += \"</div>\";\n            } else {\n                content += getTextLines(step.text);\n                content += getHelpButton(step.helpPage);\n            }\n            step.text = content;\n            tour.addStep(\"step-\" + idx, step);\n        });\n\n        function getTextLines(text) {\n            var content = \"\";\n            for (var i = 0; i < text.length; i++) {\n                content += \"<p class='lead'>\" + text[i] + \"</p>\";\n            }\n            return content;\n        }\n\n        function getHelpButton(page) {\n            var content = \"\";\n            if (page) {\n                var helpUrl = \"http://shuup-guide.readthedocs.io/en/latest/\" + page;\n                content += \"<br>\";\n                content += \"<p class='text-center'>\";\n                content += \"<a href='\" + helpUrl + \"' class='btn btn-inverse btn-default', target='_blank'>\";\n                content += \"<i class='fa fa-info-circle'></i> \" + gettext(\"Learn more at the Shuup Help Center\");\n                content += \"</a>\";\n                content += \"</p>\";\n            }\n            return content;\n        }\n        function getTourButtons(type) {\n            var buttons = [];\n            if (type !== \"first\" && type !== \"last\") {\n                buttons.push({\n                    text: \"Previous\",\n                    classes: \"btn shepherd-button-secondary\",\n                    action: tour.back\n                });\n            }\n\n            if (type == \"last\") {\n                buttons.push({\n                    text: \"OK\",\n                    classes: \"btn btn-primary\",\n                    action: tour.cancel\n                });\n            } else {\n                buttons.push({\n                    text: \"Next\",\n                    classes: \"btn btn-primary\",\n                    action: tour.next\n                });\n            }\n\n            return buttons;\n        }\n\n        if (config.tourKey) {\n            tour.on(\"cancel\", function () {\n                $.post(\"/sa/tour/\", { \"csrfmiddlewaretoken\": window.ShuupAdminConfig.csrf, \"tourKey\": config.tourKey });\n            });\n        }\n        tour.start();\n        return tour;\n    };\n})(jQuery);\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\n(function () {\n    $(\".lightbox\").imageLightbox({\n        \"button\": true,\n        \"overlay\": true\n    });\n})();\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\nwindow.targetElement = null;\nwindow.sourceElement = null;\n\nfunction updateOrdering(e) {\n    var items = \"\";\n    window.targetElement.find(\"input[type=checkbox]\").each(function (idx, elem) {\n        items += $(elem).attr(\"name\") + \"|\";\n    });\n    $(\"#ordering\").text(items);\n}\n\nfunction removeFromActive(e) {\n    e.preventDefault();\n\n    var label = $(this).data(\"label\");\n    var name = $(this).data(\"name\");\n\n    var $source = $(\"#target-placeholder li\");\n    var html = $source.html().replace(/NAME/g, name).replace(/LABEL/g, label);\n    window.sourceElement.append($(\"<li>\").html(html));\n    $(this).closest(\"li\").remove();\n    updateOrdering();\n}\n\nfunction addToActive(e) {\n    e.preventDefault();\n\n    var label = $(this).data(\"label\");\n    var name = $(this).data(\"name\");\n\n    var $source = $(\"#source-placeholder li\");\n    var html = $source.html().replace(/NAME/g, name).replace(/LABEL/g, label);\n    window.targetElement.append($(\"<li>\").html(html));\n    $(this).closest(\"li\").remove();\n    updateOrdering();\n}\n\nwindow.activateSortable = function (targetElement, sourceElement) {\n    var $target = $(\"#\" + targetElement);\n    var $source = $(\"#\" + sourceElement);\n    window.targetElement = $target;\n    window.sourceElement = $source;\n\n    var el = document.getElementById(targetElement);\n    var sortable = Sortable.create(el, {\n        handle: \".sorting-handle\",\n        onEnd: function onEnd( /**Event*/evt) {\n            updateOrdering();\n        }\n    });\n    updateOrdering();\n    $(document).on(\"click\", \".btn-remove-sortable\", removeFromActive);\n    $(document).on(\"click\", \".btn-add-sortable\", addToActive);\n};\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n(function () {\n    // https://gist.github.com/mathewbyrne/1280286\n    function slugify(text) {\n        return text.toString().toLowerCase().replace(/\\s+/g, '-') // Replace spaces with -\n        .replace(/[^\\w\\-]+/g, '') // Remove all non-word chars\n        .replace(/\\-\\-+/g, '-') // Replace multiple - with single -\n        .replace(/^-+/, '') // Trim - from start of text\n        .replace(/-+$/, ''); // Trim - from end of text\n    }\n\n    function autoSlugify() {\n        var val = $(this).val();\n        $(this).parent().next().find(\".slugfield\").val(slugify(val));\n    }\n    $(document).on(\"keyup\", \".autoupdate-slug\", autoSlugify);\n})();\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\nfunction activateDropzone($dropzone) {\n    var attrs = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n    var selector = \"#\" + $dropzone.attr(\"id\");\n    var uploadPath = $(selector).data().upload_path;\n    var addRemoveLinks = $(selector).data().add_remove_links;\n    var params = $.extend(true, {\n        url: \"/sa/media/?action=upload&path=\" + uploadPath,\n        params: {\n            csrfmiddlewaretoken: window.ShuupAdminConfig.csrf\n        },\n        addRemoveLinks: addRemoveLinks == \"True\",\n        dictRemoveFile: gettext(\"Clear\"),\n        autoProcessQueue: true,\n        uploadMultiple: false,\n        parallelUploads: 1,\n        maxFiles: 1,\n        dictDefaultMessage: gettext(\"Drop files here or click to browse.\"),\n        clickable: false,\n        accept: function accept(file, done) {\n            if ($(selector).data().kind === \"images\" && file.type.indexOf(\"image\") < 0) {\n                done(gettext(\"only images can be uploaded!\"));\n            } else {\n                done();\n            }\n        }\n    }, attrs);\n    var dropzone = new Dropzone(selector, params);\n\n    dropzone.on(\"addedfile\", attrs.onAddedFile || function (file) {\n        if (params.maxFiles === 1 && dropzone.files.length > 1) {\n            dropzone.removeFile(dropzone.files[0]);\n        }\n    });\n\n    dropzone.on(\"removedfile\", attrs.onSuccess || function (data) {\n        $(selector).find(\"input\").val(\"\");\n    });\n\n    dropzone.on(\"success\", attrs.onSuccess || function (data) {\n        // file selected through dnd\n        if (data.xhr) {\n            data = JSON.parse(data.xhr.responseText).file;\n        }\n        $(selector).find(\"input\").val(data.id);\n    });\n\n    dropzone.on(\"queuecomplete\", attrs.onQueueComplete || $.noop);\n\n    $(selector).on(\"click\", function (e) {\n        window.BrowseAPI.openBrowseWindow({\n            kind: \"media\",\n            disabledMenus: [\"delete\", \"rename\"],\n            filter: $(selector).data().kind,\n            onSelect: function onSelect(obj) {\n                obj.name = obj.text;\n                $(selector).find(\"input\").val(obj.id);\n                $(selector).find(\".dz-preview\").remove();\n                dropzone.emit(\"addedfile\", obj);\n                if (obj.thumbnail) {\n                    dropzone.emit(\"thumbnail\", obj, obj.thumbnail);\n                }\n                dropzone.emit(\"success\", obj);\n                dropzone.emit(\"complete\", obj);\n            }\n        });\n    });\n\n    var data = $(selector).data();\n    if (data.url) {\n        dropzone.files.push(data);\n        dropzone.emit(\"addedfile\", data);\n        if (data.thumbnail) {\n            dropzone.emit(\"thumbnail\", data, data.thumbnail);\n        }\n        dropzone.emit(\"complete\", data);\n    }\n}\n\nfunction activateDropzones() {\n    $(\"div[data-dropzone='true']\").each(function (idx, object) {\n        var dropzone = $(object);\n        if (!dropzone.attr(\"id\").includes(\"__prefix__\") && dropzone.find(\".dz-message\").length === 0) {\n            activateDropzone(dropzone);\n        }\n    });\n}\n\n$(function () {\n    Dropzone.autoDiscover = false;\n    activateDropzones();\n});\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\n\nwindow.addToSelect2 = function addToSelect2(target, value, name) {\n    var newOption = new Option(name, value, true, true);\n    $(\"select[name='\" + target + \"']\").append(newOption).trigger('change');\n\n    // Product update or create\n    if (target.includes(\"primary_category\")) {\n        var categories = $(\"select[name*='categories']\");\n        if (categories.length > 0) {\n            var _newOption = new Option(name, value, true, true);\n            categories.append(_newOption).trigger('change');\n        }\n    }\n\n    window.closeQuickAddIFrame();\n};\n\nwindow.closeQuickAddIFrame = function closeQuickAddIFrame(e) {\n    if (e !== undefined) {\n        e.preventDefault();\n    }\n    $(\"#create-object-overlay\").remove();\n};\n\n$(function () {\n    $('.quick-add-btn a.btn').on(\"click\", function (e) {\n        e.preventDefault();\n        window.closeQuickAddIFrame();\n        var url = $(this).data(\"url\");\n        var overlay = document.createElement(\"div\");\n        overlay.id = \"create-object-overlay\";\n\n        var contentPane = document.createElement('div');\n        contentPane.id = \"create-object-content-pane\";\n        contentPane.className = \"content-pane\";\n        overlay.appendChild(contentPane);\n\n        var closeIcon = document.createElement(\"i\");\n        closeIcon.className = \"fa fa-times-circle-o fa-3x text-danger\";\n        var closeButton = document.createElement(\"a\");\n        closeButton.className = \"close-btn\";\n        closeButton.href = \"#\";\n        closeButton.onclick = window.closeQuickAddIFrame;\n        closeButton.appendChild(closeIcon);\n        contentPane.appendChild(closeButton);\n\n        var iframe = document.createElement('iframe');\n        iframe.frameBorder = 0;\n        iframe.width = \"100%\";\n        iframe.height = \"100%\";\n        iframe.id = \"create-object-iframe\";\n\n        iframe.onload = function () {\n            $(\"#create-object-content-pane\").addClass(\"open\");\n        };\n\n        iframe.setAttribute(\"src\", url);\n        contentPane.appendChild(iframe);\n        $(document.body).append(overlay);\n    });\n});\n\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\nfunction activateEditor($editor) {\n    var attrs = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n    return $editor.summernote($.extend(true, {\n        height: 200,\n        callbacks: {\n            onBlur: function onBlur() {\n                $editor.parent().find(\"textarea.hidden\").val($(this).summernote('code'));\n            }\n        }\n    }, attrs));\n}\n\nfunction activateEditors() {\n    $(\".summernote-editor\").each(function (idx, object) {\n        var $editor = $(object);\n        if ($editor.parent().find(\".note-editor\").length === 0) {\n            activateEditor($editor);\n        }\n    });\n}\n\n$(function () {\n    activateEditors();\n});","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nwindow.setNextActionAndSubmit = function(formId, nextAction) {\n    const $form = $(\"#\" + formId);\n    if (!$form.length) {\n        return;\n    }\n    var $nextAction = $form.find(\"input[name=__next]\");\n    if (!$nextAction.length) {\n        $nextAction = $(\"<input>\", {\n            type: \"hidden\",\n            name: \"__next\"\n        });\n        $form.append($nextAction);\n    }\n    $nextAction.val(nextAction);\n    $form.submit();\n};\n\nfunction serializeForm($form) {\n    const arrayData = $form.serializeArray();\n    let objectData = {};\n    for(let i = 0; i < arrayData.length; i++) {\n        let obj = arrayData[i];\n        var value;\n        if(obj.value !== null) {\n            value = obj.value;\n        } else {\n            value = \"\";\n        }\n\n        if(typeof objectData[obj.name] !== \"undefined\") {\n            if(!$.isArray(objectData[obj.name])) {\n                objectData[obj.name] = [objectData[obj.name]];\n            }\n            objectData[obj.name].push(value);\n        } else {\n            objectData[obj.name] = value;\n        }\n    }\n    return objectData;\n}\n\nfunction renderFormErrors($form, errors) {\n    for(let formName in errors) {\n        let formErrors = errors[formName];\n        for(let fieldName in formErrors) {\n            let fieldErrors = formErrors[fieldName].join(\" \");\n            if(fieldName === \"__all__\") {\n                $form.parent().find(\".errors\").append('<div class=\"alert alert-danger\">' + fieldErrors + '</div>');\n            } else {\n                let $field = $form.find(\":input[name='\" + formName + \"-\" + fieldName + \"']\").parent(\".form-group\");\n                $field.append(\"<span class='help-block error-block'>\" + fieldErrors + \"</span>\").addClass(\"has-error\");\n            }\n        }\n    }\n}\n\nfunction clearErrors($form) {\n    $form.find(\".has-error\").removeClass(\"has-error\");\n    $form.find(\".error-block\").remove();\n    $form.parent().find(\".errors\").empty();\n}\n\n$(function() {\n    $(\".language-dependent-content\").each(function() {\n        const $ctr = $(this);\n        var firstTabWithErrorsOpened = false;\n        $ctr.find(\".nav-tabs li\").each(function() {\n            const $tab = $(this);\n            const lang = $tab.data(\"lang\");\n            if (!lang) {\n                return;\n            }\n            const $tabPane = $ctr.find(\".tab-pane[data-lang=\" + lang + \"]\");\n            if (!$tabPane) {\n                return;\n            }\n            const tabHasErrors = ($tabPane.find(\".has-error\").length > 0);\n            if (tabHasErrors) {\n                const $tabLink = $tab.find(\"a\");\n                $tabLink.append($(\" <div class=error-indicator><i class=\\\"fa fa-exclamation-circle\\\"></i></div>\"));\n                if (!firstTabWithErrorsOpened) {\n                    $tabLink.tab(\"show\");\n                    firstTabWithErrorsOpened = true;\n                }\n            }\n        });\n    });\n}());\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nfunction changeLanguage() {\n    const form = document.createElement(\"form\");\n    form.method = \"POST\";\n    form.action = window.ShuupAdminConfig.browserUrls.setLanguage;\n    const input = document.createElement(\"input\");\n    input.type = \"hidden\";\n    input.name = \"language\";\n    input.id = \"language-field\";\n    input.value = $(this).data(\"value\");\n    form.appendChild(input);\n    document.body.appendChild(form);\n    form.submit();\n}\n\n$(function(){\n    \"use strict\";\n    $(\".languages li a\").click(changeLanguage);\n});\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nfunction activateSelect($select, model, attrs={}) {\n    if(model === undefined) {\n        return $select.select2($.extend(true, {\n            language: \"xx\"\n        }, attrs));\n    }\n    return $select.select2($.extend(true, {\n        language: \"xx\",\n        minimumInputLength: 3,\n        ajax: {\n            url: \"/sa/select\",\n            dataType: \"json\",\n            data: function(params) {\n                return {model: model, search: params.term};\n            },\n            processResults: function (data) {\n                return {\n                    results: $.map(data.results, function (item) {\n                        return {text: item.name, id: item.id};\n                    })\n                };\n            }\n        }\n    }, attrs));\n}\n\nfunction activateSelects() {\n    $(\"select\").each(function(idx, object) {\n        const select = $(object);\n        // only activate selects that aren't already select2 inputs\n        if (!select.hasClass(\"select2-hidden-accessible\") && !select.hasClass(\"no-select2\")) {\n            const model = select.data(\"model\");\n            activateSelect(select, model);\n        }\n    });\n}\n\n$(function(){\n    // Handle localization with Django instead of using select2 localization files\n    $.fn.select2.amd.define(\"select2/i18n/xx\", [], function () {\n        return {\n            errorLoading: function () {\n                return gettext(\"The results could not be loaded\");\n            },\n            inputTooLong: function (args) {\n                var overChars = args.input.length - args.maximum;\n                var message = ngettext(\n                    \"Please delete %s character\",\n                    \"Please delete %s characters\", overChars\n                );\n                return interpolate(message, [overChars]);\n            },\n            inputTooShort: function (args) {\n                var remainingChars = args.minimum - args.input.length;\n                return interpolate(gettext(\"Please enter %s or more characters\"), [remainingChars]);\n            },\n            loadingMore: function () {\n                return gettext(\"Loading more results...\");\n            },\n            maximumSelected: function (args) {\n                var message = ngettext(\n                    \"You can only select %s item\",\n                    \"You can only select %s items\", args.maximum\n                );\n                return interpolate(message, [args.maximum]);\n            },\n            noResults: function () {\n                return gettext(\"No results found\");\n            },\n            searching: function () {\n                return gettext(\"Searching...\");\n            }\n        };\n    });\n\n    activateSelects();\n});\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nwindow.targetElement = null;\nwindow.sourceElement = null;\n\nfunction updateOrdering(e) {\n    var items = \"\"\n    window.targetElement.find(\"input[type=checkbox]\").each(function(idx, elem) {\n       items += $(elem).attr(\"name\") + \"|\";\n    });\n    $(\"#ordering\").text(items);\n}\n\nfunction removeFromActive(e) {\n    e.preventDefault();\n\n    var label = $(this).data(\"label\");\n    var name = $(this).data(\"name\");\n\n    const $source = $(\"#target-placeholder li\");\n    const html = $source.html().replace(/NAME/g, name).replace(/LABEL/g, label);\n    window.sourceElement.append($(\"<li>\").html(html));\n    $(this).closest(\"li\").remove();\n    updateOrdering();\n}\n\nfunction addToActive(e) {\n    e.preventDefault();\n\n    var label = $(this).data(\"label\");\n    var name = $(this).data(\"name\");\n\n    const $source = $(\"#source-placeholder li\");\n    const html = $source.html().replace(/NAME/g, name).replace(/LABEL/g, label);\n    window.targetElement.append($(\"<li>\").html(html));\n    $(this).closest(\"li\").remove();\n    updateOrdering();\n}\n\nwindow.activateSortable = function(targetElement, sourceElement) {\n    var $target = $(\"#\" + targetElement);\n    var $source = $(\"#\" + sourceElement);\n    window.targetElement = $target;\n    window.sourceElement = $source;\n\n    var el = document.getElementById(targetElement);\n    var sortable = Sortable.create(el, {\n        handle: \".sorting-handle\",\n        onEnd: function (/**Event*/evt) {\n            updateOrdering();\n        }\n    });\n    updateOrdering();\n    $(document).on(\"click\", \".btn-remove-sortable\", removeFromActive);\n    $(document).on(\"click\", \".btn-add-sortable\", addToActive);\n};\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nfunction activateDropzone($dropzone, attrs={}) {\n    const selector = \"#\" + $dropzone.attr(\"id\");\n    const uploadPath = $(selector).data().upload_path;\n    const addRemoveLinks = $(selector).data().add_remove_links;\n    const params = $.extend(true, {\n        url: \"/sa/media/?action=upload&path=\" + uploadPath,\n        params: {\n            csrfmiddlewaretoken: window.ShuupAdminConfig.csrf\n        },\n        addRemoveLinks: (addRemoveLinks == \"True\"),\n        dictRemoveFile: gettext(\"Clear\"),\n        autoProcessQueue: true,\n        uploadMultiple: false,\n        parallelUploads: 1,\n        maxFiles: 1,\n        dictDefaultMessage: gettext(\"Drop files here or click to browse.\"),\n        clickable: false,\n        accept: function(file, done) {\n            if ($(selector).data().kind === \"images\" && file.type.indexOf(\"image\") < 0) {\n                done(gettext(\"only images can be uploaded!\"));\n            } else {\n                done();\n            }\n        }\n    }, attrs);\n    const dropzone = new Dropzone(selector, params);\n\n\n    dropzone.on(\"addedfile\", attrs.onAddedFile || function(file) {\n        if(params.maxFiles === 1 && dropzone.files.length > 1) {\n            dropzone.removeFile(dropzone.files[0]);\n        }\n    });\n\n    dropzone.on(\"removedfile\", attrs.onSuccess || function(data){\n        $(selector).find(\"input\").val(\"\");\n    });\n\n    dropzone.on(\"success\", attrs.onSuccess || function(data){\n        // file selected through dnd\n        if(data.xhr) {\n            data = JSON.parse(data.xhr.responseText).file;\n        }\n        $(selector).find(\"input\").val(data.id);\n    });\n\n    dropzone.on(\"queuecomplete\", attrs.onQueueComplete || $.noop);\n\n    $(selector).on(\"click\", function(e) {\n        window.BrowseAPI.openBrowseWindow({\n            kind: \"media\",\n            disabledMenus: [\"delete\", \"rename\"],\n            filter: $(selector).data().kind,\n            onSelect: (obj) => {\n                obj.name = obj.text;\n                $(selector).find(\"input\").val(obj.id);\n                $(selector).find(\".dz-preview\").remove();\n                dropzone.emit(\"addedfile\", obj);\n                if(obj.thumbnail) {\n                    dropzone.emit(\"thumbnail\", obj, obj.thumbnail);\n                }\n                dropzone.emit(\"success\", obj);\n                dropzone.emit(\"complete\", obj);\n            }\n        });\n    });\n\n    const data = $(selector).data();\n    if(data.url) {\n        dropzone.files.push(data);\n        dropzone.emit(\"addedfile\", data);\n        if(data.thumbnail){\n            dropzone.emit(\"thumbnail\", data, data.thumbnail);\n        }\n        dropzone.emit(\"complete\", data);\n    }\n}\n\nfunction activateDropzones() {\n    $(\"div[data-dropzone='true']\").each(function(idx, object) {\n        const dropzone = $(object);\n        if(!dropzone.attr(\"id\").includes(\"__prefix__\") && dropzone.find(\".dz-message\").length === 0) {\n            activateDropzone(dropzone);\n        }\n    });\n}\n\n$(function(){\n    Dropzone.autoDiscover = false;\n    activateDropzones();\n});\n","\n/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nfunction activateEditor($editor, attrs={}) {\n    return $editor.summernote($.extend(true, {\n        height: 200,\n        callbacks: {\n            onBlur: function() {\n                $editor.parent().find(\"textarea.hidden\").val($(this).summernote('code'));\n            }\n        }\n    }, attrs));\n}\n\nfunction activateEditors() {\n    $(\".summernote-editor\").each(function(idx, object) {\n        const $editor = $(object);\n        if($editor.parent().find(\".note-editor\").length === 0){\n            activateEditor($editor);\n        }\n    });\n}\n\n$(function(){\n    activateEditors();\n});\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n/**\n * Materialize a Mithril.js virtual tree into a DOM node.\n * @param mithrilElement The virtual tree's root (a retval of `m()`)\n * @returns {Node} The materialized root of the virtual tree\n */\nwindow.materialize = function materialize(mithrilElement) {\n    // Cache a document fragment for materialization\n    const root = (window._materializeRoot || (window._materializeRoot = document.createDocumentFragment()));\n\n    // Render something into that root\n    m.render(root, mithrilElement, true);\n\n    // Then return the first child\n    return root.firstChild;\n};\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n$(function() {\n    \"use strict\";\n\n    function openMainNav() {\n        $(document.body).addClass(\"menu-open\");\n    }\n\n    function closeMainNav() {\n        $(document.body).removeClass(\"menu-open\");\n    }\n\n    function mainNavIsOpen() {\n        return $(document.body).hasClass(\"menu-open\");\n    }\n\n    $(\"#menu-button\").click(function(event) {\n        closeAllSubmenus();\n        $(\"#site-search.mobile\").removeClass(\"open\"); // Close search if open on mobile\n        event.stopPropagation();\n        if (mainNavIsOpen()) {\n            closeMainNav();\n        } else {\n            openMainNav();\n        }\n    });\n\n    function closeAllSubmenus() {\n        $(\".category-submenu\").each(function(idx, elem){\n            $(elem).removeClass(\"open\");\n        });\n    }\n    $(document).on(\"click\", \"#main-menu ul.menu-list > li a\", function(e) {\n        e.preventDefault();\n        e.stopPropagation();  // do not close submenus\n        const target_id = $(this).data(\"target-id\");\n        $(\".category-submenu\").each(function(idx, elem){\n            if($(elem).attr(\"id\") != target_id) {\n                $(elem).removeClass(\"open\");\n            }\n        });\n        const $target = $(\"#\" + target_id);\n        if (!$target.length) {\n            return;\n        }\n        const isOpen = $target.hasClass(\"open\");\n        $target.toggleClass(\"open\", !isOpen);\n    });\n\n    $(window).click(function() {\n        closeAllSubmenus();\n    });\n\n    $('.category-submenu').click(function(event){\n        event.stopPropagation();\n        if($(event.target).hasClass(\"fa-close\")) {\n            closeAllSubmenus();\n        }\n    });\n\n    window.onresize = (function() {\n        closeAllSubmenus();\n        if($(window).width() < 768) {\n            closeMainNav();\n        }\n    });\n    if (window.Masonry) {\n        const Masonry = window.Masonry;\n        $(\".category-menu-content\").each(function(idx, elem) {\n            const msnry = new Masonry(elem, {\n                itemSelector: '.submenu-container',\n                columnWidth: '.submenu-container',\n                percentPosition: true\n            });\n        });\n    }\n});\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n$(function() {\n    \"use strict\";\n    var searchResultController = null;\n\n    function getShortcutFinder() {\n        const usedShortcuts = {\"s\": true};\n        const firstChoices = \"123456789\";\n        const lastChoices = \"abcdefghijklmnopqrstuvwxyz\";\n        return function(text) {\n            const keys = (\n                firstChoices +\n                text.toLowerCase().replace(/[^a-z0-9]+/g, \"\") +\n                lastChoices\n            ).split(\"\");\n            const key = _.detect(keys, (possibleKey) => !usedShortcuts[possibleKey]);\n            if (key !== null) {\n                usedShortcuts[key] = true;\n            }\n            return key;\n        };\n    }\n\n    function resultView(ctrl) {\n        const results = ctrl.results();\n        if (results !== null && results.length === 0) {\n            return m(\"div\", gettext(\"No results.\"));\n        }\n        const showShortcuts = !!ctrl.showShortcuts();\n        const [actionResults, standardResults] = _.partition(results, \"isAction\");\n        const getShortcut = getShortcutFinder();\n\n        const singleResultLi = function(result, linkClass) {\n            const key = (showShortcuts ? getShortcut(result.text) : null);\n            var attrs = {href: result.url, accesskey: key}\n            if(result.target){\n                attrs[\"target\"] = result.target;\n            }\n            return m(\"li\", {key: result.url},\n                m(linkClass, attrs, [\n                    (result.icon ? m(\"i.\" + result.icon) : null),\n                    result.text,\n                    (key ? m(\"span.key\", key.toUpperCase()) : null)\n                ])\n            );\n        };\n\n        const standardResultContents = m(\"div\",\n            _(standardResults).groupBy(\"category\").map(function(groupResults, category) {\n                return m(\"div.result-category\", [\n                    m(\"h3.divider\", [\"\" + category]),\n                    m(\"ul\", _.map(groupResults, (result) => singleResultLi(result, \"a.result\")))\n                ]);\n            }).value()\n        );\n\n        const actionResultContents = m(\"div\",\n            m(\"ul\", _.map(actionResults, (result) => singleResultLi(result, \"a.btn.btn-gray\")))\n        );\n\n        return m(\"div.container-fluid\",\n            m(\"div.results\", {id: \"site-search-standard-results\"}, standardResultContents),\n            m(\"div.additional\", {id: \"site-search-action-results\"}, actionResultContents)\n        );\n    }\n\n    function searchCtrl() {\n        const ctrl = this;\n        ctrl.results = m.prop(null);\n        ctrl.showShortcuts = m.prop(false);\n        this.doSearch = function(query) {\n            if (!query) {\n                ctrl.results([]);\n                m.redraw();\n                return;\n            }\n            $.ajax({\n                url: window.ShuupAdminConfig.searchUrl,\n                data: {\"q\": query}\n            }).done(function(data) {\n                ctrl.results(data.results);\n                m.redraw();\n            });\n        };\n        const setShowShortcuts = function(event) {\n            if (event.keyCode === 18) { // 18 = alt\n                ctrl.showShortcuts(event.type === \"keydown\");\n                m.redraw();\n            }\n        };\n        document.addEventListener(\"keydown\", setShowShortcuts, false);\n        document.addEventListener(\"keyup\", setShowShortcuts, false);\n    }\n\n    var doSearch = function(query) {\n        if (!searchResultController) {\n            const container = document.getElementById(\"site-search-results\");\n            searchResultController = m.mount(container, {controller: searchCtrl, view: resultView});\n        }\n        searchResultController.doSearch(query);\n    };\n\n    const doSearchDebounced = _.debounce(doSearch, 500);\n\n    $(document).click(function(e) {\n        if (!$(e.target).closest(\"#site-search\").length) {\n            $(\"#site-search-results\").slideUp(400, \"easeOutCubic\");\n        }\n    });\n\n    // Disable default behaviour on mobile for the search dropdown.\n    // The dropdown now stays open if clicked into the input field\n    $(\".mobile-search-dropdown\").click(function(e) {\n        e.stopPropagation();\n    });\n\n    // Hide search results if results are open and search parent element is clicked\n    $(\"#site-search\").find(\".mobile\").click(function() {\n        if ($(this).hasClass(\"open\")) {\n            $(\"#site-search-results\").slideUp(400, \"easeOutCubic\");\n        }\n    });\n\n    function closeMobileSearchResults() {\n        var windowWidth = $(window).outerWidth(true);\n        var $siteSearchResults = $(\"#site-search-results\");\n        if ($siteSearchResults.is(\":visible\") && windowWidth < 768) {\n            $siteSearchResults.slideUp(400, \"easeOutCubic\");\n        }\n    }\n\n    $(window).resize(_.debounce(closeMobileSearchResults, 100));\n\n    const $searchInputs = $(\"#site-search-input, #site-search-input-mobile\");\n\n    $searchInputs.on(\"keyup\", function() {\n        var query = $(this).val();\n        if (query.length > 0) {\n            $(\"#site-search-results\").slideDown(300, \"easeInSine\");\n            doSearchDebounced(query);\n        } else {\n            $(\"#site-search-results\").slideUp(400, \"easeOutSine\");\n        }\n    });\n    $searchInputs.on(\"focus\", function() {\n        if ($(this).val().length > 0) {\n            $(\"#site-search-results\").slideDown(300, \"easeInSine\");\n        }\n    });\n});\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n$(function() {\n    \"use strict\";\n    $(\"[data-toggle='popover']\").popover();\n}());\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n$(function() {\n    \"use strict\";\n    $(\"[data-toggle=\\\"tooltip\\\"]\").tooltip({\n        delay: {\"show\": 750, \"hide\": 100}\n    });\n    $(\"#dropdownMenu\").tooltip({\n        delay: {\"show\": 750, \"hide\": 100}\n    });\n}());\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n$(function() {\n    \"use strict\";\n    function update() {\n        $(\".timesince\").each(function() {\n            const $el = $(this);\n            const ts = $el.data(\"ts\");\n            if (!ts) {\n                return;\n            }\n            const time = moment(ts);\n            if (!time.isValid()) {\n                return;\n            }\n            $el.text(time.fromNow());\n        });\n    }\n    update();\n    setInterval(update, 60000);\n});\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nwindow.Messages = (function Messages(document) {\n    const queue = [];\n    var container = null;\n    function createContainer() {\n        if (!container) {\n            container = document.createElement(\"div\");\n            container.id = \"message-container\";\n            document.body.appendChild(container);\n            document.addEventListener(\"click\", hideOnClickOut, false);\n        }\n    }\n    function show() {\n        if (container) {\n            container.classList.remove(\"clear\");\n            container.classList.add(\"visible\");\n        }\n    }\n    function hide() {\n        if (container) {\n            container.classList.remove(\"visible\");\n            container.classList.add(\"clear\");\n            setTimeout(clear, 2000);\n        }\n    }\n    function clear() {\n        container.classList.remove(\"clear\");\n        while (container && container.firstChild) {\n            container.removeChild(container.firstChild);\n        }\n    }\n    function hideOnClickOut(event) {\n        var node = event.target;\n        while (node) {\n            if (node.id === \"message-container\") {\n                return;\n            }\n            node = node.parentNode;\n        }\n        hide();\n    }\n    function renderMessage(message) {\n        const messageDiv = document.createElement(\"div\");\n        var tags = message.tags || [];\n        if (_.isString(tags)) {\n            tags = tags.split(\" \");\n        }\n        messageDiv.className = \"message \" + tags.join(\" \");\n        const textSpan = document.createElement(\"span\");\n        const textNode = document.createTextNode(message.text || \"no text\");\n        textSpan.appendChild(textNode);\n        messageDiv.appendChild(textSpan);\n        return messageDiv;\n    }\n    function flush() {\n        if (!queue.length) {\n            return;\n        }\n        if (!document.body) {  // Try again soon\n            return setTimeout(flush, 50);\n        }\n        createContainer();\n        while (queue.length > 0) {\n            container.appendChild(renderMessage(queue.shift()));\n        }\n        _.defer(show);\n    }\n    const deferredFlush = _.debounce(flush, 50);\n    function enqueue(message) {\n        queue.push(message);\n        deferredFlush();\n    }\n\n    return {\n        enqueue: enqueue,\n        hide: hide\n    };\n}(window.document));\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n/**\n * Support for media browsing widgets.\n * Currently opens a real, actual, true-to-1998\n * popup window (just like the Django admin, mind)\n * but could just as well use an <iframe> modal.\n */\n\nwindow.BrowseAPI = (function() {\n    const browseData = {};\n\n    window.addEventListener(\"message\", function (event) {\n        const data = event.data;\n        if (!data.pick) {\n            return;\n        }\n        const info = browseData[data.pick.id];\n        if (!info) {\n            return;\n        }\n        info.popup.close();\n        const obj = data.pick.object;\n        if (!obj) {\n            return;\n        }\n        if (_.isFunction(info.onSelect)) {\n            info.onSelect.call(this, obj);\n        }\n        delete browseData[data.pick.id];\n    }, false);\n\n    /**\n     * Open a browsing window with the given options.\n     *\n     * Currently supported options are:\n     * * `kind`: kind string (e.g. \"product\")\n     * * `filter`: filter string (kind-dependent)\n     * * `onSelect`: a function invoked when an object is selected\n     * @return {Object}\n     */\n    function openBrowseWindow(options) {\n        var filter = options.filter;\n        const disabledMenus = options.disabledMenus;\n        const kind = options.kind;\n        const browserUrl = window.ShuupAdminConfig.browserUrls[kind];\n        if (!browserUrl) {\n            throw new Error(gettext(\"No browser URL for kind:\") + \" \" + kind);\n        }\n        if(typeof filter !== \"string\") {\n            filter = JSON.stringify(filter);\n        }\n        const id = \"m-\" + (+new Date);\n        const qs = _.compact([\n            \"popup=1\",\n            \"pick=\" + id,\n            (filter ? \"filter=\" + filter : null),\n            (disabledMenus ? \"disabledMenus=\" + disabledMenus.join(\",\") : null)\n        ]).join(\"&\");\n        const popup = window.open(\n            browserUrl + (browserUrl.indexOf(\"?\") > -1 ? \"&\" : \"?\") + qs,\n            \"browser_popup_\" + id,\n            \"resizable,menubar=no,location=no,scrollbars=yes\"\n        );\n        return browseData[id] = _.extend(\n            {popup, $container: null, onSelect: null},\n            options\n        );\n    }\n\n    return {\n        openBrowseWindow\n    };\n}());\n\n$(function() {\n    $(document).on(\"click\", \".browse-widget .browse-btn\", function() {\n        const $container = $(this).closest(\".browse-widget\");\n        if (!$container.length) {\n            return;\n        }\n        const kind = $container.data(\"browse-kind\");\n        const filter = $container.data(\"filter\");\n        try {\n            return window.BrowseAPI.openBrowseWindow({kind, filter, onSelect: (obj) => {\n                $container.find(\"input\").val(obj.id);\n                const $text = $container.find(\".browse-text\");\n                $text.text(obj.text);\n                $text.prop(\"href\", obj.url || \"#\");\n            }});\n        } catch(e) {\n            alert(e);\n            return false;\n        }\n    });\n\n    $(document).on(\"click\", \".browse-widget .clear-btn\", function() {\n        const $container = $(this).closest(\".browse-widget\");\n        if (!$container.length) {\n            return;\n        }\n        const emptyText = $container.data(\"empty-text\") || \"\";\n        $container.find(\"input\").val(\"\");\n        const $text = $container.find(\".browse-text\");\n        $text.text(emptyText);\n        $text.prop(\"href\", \"#\");\n    });\n\n    $(document).on(\"click\", \".browse-widget .browse-text\", function(event) {\n        const href = $(this).prop(\"href\");\n        if (/#$/.test(href)) {  // Looks empty, so prevent clicks\n            event.preventDefault();\n            return false;\n        }\n    });\n});\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n$(function() {\n    \"use strict\";\n    /**\n     * Return a Mithril module to create a navigator for the given navigatee form (jQuery object)\n     */\n    function getSectionNavigatorModule($navigateeForm) {\n        const $sections = $navigateeForm.find(\".content-block\");\n\n        const navigationListItems = _.compact(_.map($sections, function(section) {\n            const $section = $(section);\n            const $blockTitle = $section.find(\".block-title\");\n            const titleText = $blockTitle.text();\n            if (!titleText) {\n                return;\n            }\n            if (!section.id) {\n                section.id = _.kebabCase(titleText) + \"-section\";\n            }\n\n            return {\n                el: section,\n                id: section.id,\n                title: titleText,\n                iconClass: $blockTitle.find(\".fa\").attr(\"class\"),\n                errorClass: ($section.find(\".has-error\").length ? \"normal\" : null)\n            };\n        }));\n\n        if (!navigationListItems.length) {\n            return null;\n        }\n\n        return {\n            view: function view(ctrl) {\n                const currentId = ctrl.currentItemId();\n                return m(\"div.sidebar-list\", ctrl.navigationListItems().map(function(item) {\n                    const classes = (item.id === currentId ? \".active\" : \"\") + (item.errorClass ? \".errors\" : \"\");\n                    return m(\n                        \"a.sidebar-list-item\" + classes,\n                        {\n                            key: item.id,\n                            href: \"#\" + item.id,\n                            onclick: function() {\n                                ctrl.showSection(item);\n                                return false;\n                            }\n                        },\n                        [\n                            (item.iconClass ? m(\"i\", {className: item.iconClass}) : null),\n                            item.title,\n                            (item.errorClass ? m(\n                                \"div.error-indicator.\" + item.errorClass,\n                                m(\"i.fa.fa-exclamation-circle\")\n                            ) : null)\n                        ]\n                    );\n                }));\n            },\n            controller: function controller() {\n                const ctrl = this;\n                ctrl.showSection = function(section) {\n                    $sections.hide();\n                    if (section.errorClass) {\n                        section.errorClass = \"dismissed\";\n                    }\n                    const $visibleSection = $(\"#\" + section.id);\n                    $visibleSection.show();\n                    ctrl.currentItemId(section.id);\n                };\n                ctrl.currentItemId = m.prop(null);\n                ctrl.navigationListItems = m.prop(navigationListItems);\n                ctrl.showSection(navigationListItems[0]);\n            }\n        };\n    }\n    function activateSectionNavigation($sectionNavigation) {\n        if (!$sectionNavigation.length) {\n            return;\n        }\n        const navigateeId = $sectionNavigation.data(\"navigatee\");\n        const $navigateeForm = $(\"#\" + navigateeId);\n        if (!$navigateeForm.length) {\n            return;\n        }\n        m.mount($sectionNavigation[0], getSectionNavigatorModule($navigateeForm));\n    }\n    $(\".section-navigation, #section-navigation\").each(function() {\n        activateSectionNavigation($(this));\n    });\n\n    if(location.hash) {\n        const $section = $(\"a[href='\" + location.hash + \"']\");\n        if($section.length) {\n            $section.trigger(\"click\");\n        } else {\n            location.hash = \"\";\n        }\n    }\n});\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n$(function() {\n    let $contentBlocks = $(\".content-block\");\n    let $contentWraps = $contentBlocks.find(\".content-wrap\");\n\n    $(\".toggle-contents\").click(function(event) {\n        const $collapseElement = $(this).closest(\".content-block\").find(\".content-wrap\");\n        event.preventDefault();\n\n        // Checks if the bootstrap collapse animation is not ongoing\n        if (!$collapseElement.hasClass(\"collapsing\")) {\n            $collapseElement.collapse(\"toggle\");\n            $(this).closest(\".title\").toggleClass(\"open\");\n        }\n    });\n    $contentBlocks.each(function() {\n        if ($(this).find(\".has-error\").length) {\n            $(this).find(\".block-title\").addClass(\"mobile-error-indicator\");\n        }\n    });\n\n    // Activate first sidebar-list-item with errors\n    $(\"a.sidebar-list-item.errors\").first().trigger(\"click\");\n\n    // clear inline height: 0 on resize since we want blocks to be expanded on medium screens\n    // this circumvents the need for !important in our css\n    $(window).resize(_.debounce(function(){\n        $contentWraps.css(\"height\", \"\");\n        $(\"#main-content\").css(\"margin-top\", $(\".support-nav-wrap\").height() + 15);\n    }, 100));\n\n    $(window).ready(function() {\n        $(\"#main-content\").css(\"margin-top\", $(\".support-nav-wrap\").height() + 15);\n    });\n});\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n(function($) {\n    \"use strict\";\n\n    const allowedButtons = \"input[type=\\\"submit\\\"], input[type=\\\"image\\\"], button:not([type]), button[type=\\\"submit\\\"]\";\n    const formAttributes = [\"action\", \"method\", \"enctype\", \"target\", \"novalidate\"];\n\n    $.fn.formSubmissionAttributes = function() {\n        //based on https://github.com/mattberkowitz/Form-Submission-Attributes-Polyfill\n\n        this.each(function() {\n            const $form = $(this);\n            var $inputs = $form.find(allowedButtons);\n            const formId = $form.attr(\"id\");\n\n            if (formId) {\n                // find buttons that are tied to this form and add them to $inputs\n                var buttons = $(\"input[form=\\\"\" + formId + \"\\\"],button[form=\\\"\" + formId + \"\\\"]\");\n                buttons = buttons.filter(allowedButtons);\n                $inputs = $inputs.add(buttons);\n            }\n\n            //backup originals\n            $.each(formAttributes, function(idx, attr) {\n                $form.data(\"o\" + attr, $form.attr(attr));\n            });\n\n            $inputs.on(\"click\", function() {\n                const $this = $(this);\n                $.each(formAttributes, function(idx, attr) {\n                    const value = $this.is(\"[form\" + attr + \"]\") ? $this.attr(\"form\" + attr) : $form.data(\"o\" + attr);\n                    $form.attr(attr, value);\n                });\n            });\n        });\n    };\n\n    if (window.navigator.userAgent.indexOf(\"MSIE \") > 0 || !!navigator.userAgent.match(/Trident.*rv\\:11\\./))\n    {\n        $(document).on(\"click\", \"[type=submit][form]\", function(event) {\n            event.preventDefault();\n            const formId = $(this).attr(\"form\");\n            const $f = $(\"#\" + formId);\n            $f.formSubmissionAttributes();\n            $f.submit();\n        });\n    }\n}(jQuery));\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n$(function() {\n    $(\".form-control.datetime\").datetimepicker({\n        format: \"yyyy-mm-dd hh:ii\",\n        autoclose: true,\n        todayBtn: true,\n        todayHighlight: true,\n        fontAwesome: true\n    });\n    $(\".form-control.date\").datetimepicker({\n        format: \"yyyy-mm-dd\",\n        autoclose: true,\n        todayBtn: true,\n        todayHighlight: true,\n        fontAwesome: true,\n        minView: 2\n    });\n});\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n(function($) {\n    function getAppChromeSteps(key) {\n        if(key !== \"home\" && typeof(key) !== \"undefined\") {\n            return [];\n        }\n        if($(\"#main-menu\").position().left !== 0) {\n            // don't show chrome tour on mobile\n            return [];\n        }\n        let steps = [];\n        steps = steps.concat([\n            {\n                title: gettext(\"Quick Links\"),\n                text: [\n                    gettext(\"Quick Links to your most used features.\")\n                ],\n                attachTo: \"li a[data-target-id='quicklinks'] right\"\n            }, {\n                title: gettext(\"Orders\"),\n                text: [\n                    gettext(\"Track and filter your customers orders here.\"),\n                ],\n                attachTo: \"li a[data-target-id='category-1'] right\"\n            }, {\n                title: gettext(\"Products\"),\n                text: [\n                    gettext(\"All your exciting products and features are located here.\")\n                ],\n                attachTo: \"li a[data-target-id='category-2'] right\"\n            }, {\n                title: gettext(\"Contacts\"),\n                text: [\n                    gettext(\"All your customer data is located here. Target and organize your clients details your way!\")\n                ],\n                attachTo: \"li a[data-target-id='category-3'] right\"\n            }\n        ]);\n\n        if ($(\"li a[data-target-id='category-5']\").length > 0) {\n            steps.push({\n                title: gettext(\"Campaigns\"),\n                text: [gettext(\"Great loyalty tool for creating marketing, campaigns, special offers and coupons to entice your shoppers!\"), gettext(\"Set offers based on their previous purchase behavior to up- and cross sale your inventory.\")],\n                attachTo: \"li a[data-target-id='category-5'] right\"\n            });\n        }\n\n        if ($(\"li a[data-target-id='category-9']\").length > 0) {\n            steps.push({\n                title: gettext(\"Content\"),\n                text: [gettext(\"The make-over tool to customize you site themes, add pages and product carousels. Incorporate any media to make your store pop!\")],\n                attachTo: \"li a[data-target-id='category-9'] right\"\n            });\n        }\n\n        if ($(\"li a[data-target-id='category-4']\").length > 0) {\n            steps.push({\n                title: gettext(\"Reports\"),\n                text: [gettext(\"Your reporting tool to build and analyze your consumer behavior information that can assist with your business decisions.\")],\n                attachTo: \"li a[data-target-id='category-4'] right\"\n            });\n        }\n\n        steps.push({\n            title: gettext(\"Shops\"),\n            text: [gettext(\"Place for your Shop specific settings. You can customize taxes, currencies, customer groups, and many other things in this menu.\")],\n            attachTo: \"li a[data-target-id='category-6'] right\"\n        });\n\n        if ($(\"li a[data-target-id='category-7']\").length > 0) {\n            steps.push({\n                title: gettext(\"Addons\"),\n                text: [gettext(\"This is your connection interface. Addons and other systems you use can be attached to your store through powerful data connections.\"), gettext(\"Supercharge your site and gather crazy amounts of data with integrations to CRMs and ERPs, POSs and PIMs, or any other acronym you can think of.\")],\n                attachTo: \"li a[data-target-id='category-7'] right\"\n            });\n        }\n\n        steps = steps.concat([{\n            title: gettext(\"Settings\"),\n            text: [\n                gettext(\"The nuts and bolts of your store are found here. From individual country tax-regulations to your contact details.\")\n            ],\n            attachTo: \"li a[data-target-id='category-8'] right\"\n        }, {\n            title: gettext(\"Search\"),\n            text: [\n                gettext(\"Lost and cannot find your way? No worries, you can search contacts, settings, add-ons and more features from here.\")\n            ],\n            attachTo: \"#site-search bottom\"\n        }, {\n            title: gettext(\"View your storefront\"),\n            text: [\n                gettext(\"Preview your shop and all the cool features you have created!\")\n            ],\n            attachTo: \".shop-btn.visit-store left\"\n        }, {\n            title: gettext(\"We're done!\"),\n            text: [\n                gettext(\"It was nice to show you around!\"),\n                gettext(\"If you need to run it again, fire it up from the menu in the top right.\")\n            ]\n        }]);\n        return steps;\n    }\n\n    $(document).ready(function() {\n        $(\"#top-header .show-tour-li\").on(\"click\", \"a\", function(e){\n            e.preventDefault();\n            $.tour();\n        });\n    });\n\n    $.tour = function(config={}, params) {\n        if(config === \"setPageSteps\") {\n            this.pageSteps = params;\n            return;\n        }\n        let tour = new Shepherd.Tour({\n            defaults: {\n                classes: \"shepherd-theme-arrows\",\n                scrollTo: true,\n                showCancelLink: true\n            }\n        });\n\n        var steps = [];\n        if (this.pageSteps && this.pageSteps.length > 1) {\n            steps = this.pageSteps;\n        }\n        else {\n            steps = (this.pageSteps || []).concat(getAppChromeSteps(config.tourKey));\n        }\n\n        $.each(steps, (idx, step) => {\n            var buttonType = null;\n            if(idx === 0) {\n                buttonType = \"first\";\n            }\n            if(idx === steps.length - 1) {\n                buttonType = \"last\";\n            }\n            step = $.extend({}, step, {buttons: getTourButtons(buttonType)});\n            let content = \"\";\n            if(step.icon) {\n                content += \"<div class='clearfix'>\";\n                content += \"<div class='pull-left'>\";\n                content += \"<div class='icon'>\";\n                content += \"<img src='\" + step.icon + \"' />\";\n                content += \"</div>\";\n                content += \"</div>\";\n                content += \"<div class='step-with-icon'>\";\n                content += getTextLines(step.text);\n                content += getHelpButton(step.helpPage);\n                content += \"</div>\";\n                content += \"</div>\";\n            } else if(step.banner){\n                content += \"<div>\";\n                content += \"<div class='banner'>\";\n                content += \"<img src='\" + step.banner + \"' />\";\n                content += \"</div>\";\n                content += \"<div class='step-with-banner'>\";\n                content += getTextLines(step.text);\n                content += getHelpButton(step.helpPage);\n                content += \"</div>\";\n                content += \"</div>\";\n            } else {\n                content += getTextLines(step.text);\n                content += getHelpButton(step.helpPage);\n            }\n            step.text = content;\n            tour.addStep(\"step-\" + idx, step);\n        });\n\n        function getTextLines(text) {\n            let content = \"\";\n            for(let i = 0; i < text.length; i++) {\n                content += \"<p class='lead'>\" + text[i] + \"</p>\";\n            }\n            return content;\n        }\n\n        function getHelpButton(page) {\n            let content = \"\";\n            if(page) {\n                let helpUrl = \"http://shuup-guide.readthedocs.io/en/latest/\" + page;\n                content += \"<br>\";\n                content += \"<p class='text-center'>\";\n                content += \"<a href='\" + helpUrl + \"' class='btn btn-inverse btn-default', target='_blank'>\";\n                content += \"<i class='fa fa-info-circle'></i> \" + gettext(\"Learn more at the Shuup Help Center\");\n                content += \"</a>\";\n                content += \"</p>\";\n            }\n            return content;\n\n        }\n        function getTourButtons(type) {\n            let buttons = [];\n            if(type !== \"first\" && type !== \"last\") {\n                buttons.push({\n                    text: \"Previous\",\n                    classes: \"btn shepherd-button-secondary\",\n                    action: tour.back\n                });\n            }\n\n            if(type == \"last\") {\n                buttons.push({\n                    text: \"OK\",\n                    classes: \"btn btn-primary\",\n                    action: tour.cancel\n                });\n            } else {\n                buttons.push({\n                    text: \"Next\",\n                    classes: \"btn btn-primary\",\n                    action: tour.next\n                });\n            }\n\n            return buttons;\n        }\n\n        if(config.tourKey) {\n            tour.on(\"cancel\", () => {\n                $.post(\"/sa/tour/\", {\"csrfmiddlewaretoken\": window.ShuupAdminConfig.csrf, \"tourKey\": config.tourKey});\n            });\n        }\n        tour.start();\n        return tour;\n    };\n}(jQuery));\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n(function(){\n    $(\".lightbox\").imageLightbox({\n        \"button\": true,\n        \"overlay\": true,\n    });\n})();\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\n(function() {\n    // https://gist.github.com/mathewbyrne/1280286\n    function slugify(text) {\n      return text.toString().toLowerCase()\n        .replace(/\\s+/g, '-')           // Replace spaces with -\n        .replace(/[^\\w\\-]+/g, '')       // Remove all non-word chars\n        .replace(/\\-\\-+/g, '-')         // Replace multiple - with single -\n        .replace(/^-+/, '')             // Trim - from start of text\n        .replace(/-+$/, '');            // Trim - from end of text\n    }\n\n    function autoSlugify() {\n        var val = $(this).val();\n        $(this).parent().next().find(\".slugfield\").val(slugify(val));\n    }\n    $(document).on(\"keyup\", \".autoupdate-slug\", autoSlugify);\n})();\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2017, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nwindow.addToSelect2 = function addToSelect2(target, value, name) {\n    const newOption = new Option(name, value, true, true);\n    $(\"select[name='\" + target + \"']\").append(newOption).trigger('change');\n\n    // Product update or create\n    if (target.includes(\"primary_category\")) {\n        const categories = $(\"select[name*='categories']\");\n        if (categories.length > 0) {\n            const newOption = new Option(name, value, true, true);\n            categories.append(newOption).trigger('change');\n        }\n    }\n\n    window.closeQuickAddIFrame();\n};\n\nwindow.closeQuickAddIFrame = function closeQuickAddIFrame(e) {\n    if (e !== undefined) {\n        e.preventDefault();\n    }\n    $(\"#create-object-overlay\").remove();\n};\n\n$(function() {\n    $('.quick-add-btn a.btn').on(\"click\", function(e) {\n        e.preventDefault();\n        window.closeQuickAddIFrame();\n        const url = $(this).data(\"url\");\n        const overlay = document.createElement(\"div\");\n        overlay.id = \"create-object-overlay\";\n\n        const contentPane = document.createElement('div');\n        contentPane.id = \"create-object-content-pane\"\n        contentPane.className = \"content-pane\";\n        overlay.appendChild(contentPane);\n\n        const closeIcon = document.createElement(\"i\");\n        closeIcon.className = \"fa fa-times-circle-o fa-3x text-danger\";\n        const closeButton = document.createElement(\"a\");\n        closeButton.className = \"close-btn\";\n        closeButton.href = \"#\";\n        closeButton.onclick = window.closeQuickAddIFrame;\n        closeButton.appendChild(closeIcon);\n        contentPane.appendChild(closeButton);\n\n        const iframe = document.createElement('iframe');\n        iframe.frameBorder=0;\n        iframe.width=\"100%\";\n        iframe.height=\"100%\";\n        iframe.id=\"create-object-iframe\";\n\n        iframe.onload = function() {\n            $(\"#create-object-content-pane\").addClass(\"open\");\n        };\n\n        iframe.setAttribute(\"src\", url);\n        contentPane.appendChild(iframe);\n        $(document.body).append(overlay);\n    });\n});\n"],"sourceRoot":"/source/"}