"use strict";window.VariationVariableEditor=function(e,t){function n(){this.showIdentifierFields=e.prop(!1)}function a(e){o(),u()}function r(){document.getElementById("id_variables-data").value=JSON.stringify(h)}function i(){return"$"+Math.random()}function l(n,a,i){var l=arguments.length<=3||void 0===arguments[3]?"$":arguments[3],o=arguments.length<=4||void 0===arguments[4]?!0:arguments[4],u=e.withAttr("value",function(e){a.identifier=e,r()}),d=function(e,t){a[i][e]=t,r()};return[t.map(p,function(r){var o=r.name,u=r.code,c=e.withAttr("value",t.partial(d,u)),f=l.replace("$",o);return e(n,[f&&f.length?e("label",f):null,e("input.form-control",{value:a[i][u]||"",placeholder:f,oninput:c,onchange:c})])}),o?e(n,[e("input.form-control",{value:a.identifier,placeholder:gettext("Identifier"),oninput:u,onchange:u})]):null]}function o(){var e=document.getElementById("product-variable-wrap");Sortable.create(e,{group:"variable-sort",handle:".variable-sort-handle",onEnd:function(e){h.reindex(e.oldIndex,e.newIndex),r()}})}function u(e){var t=document.getElementsByClassName("product-variable-values"),e=0;[].forEach.call(t,function(t){Sortable.create(t,{group:"value-sort-"+e,handle:".value-sort-handle",onEnd:function(e){for(var t=e.item.getAttribute("data-id"),n=e.newIndex,a=null,i=null,l=0;l<h.length;l++){a=h[l];for(var o=0;o<a.values.length;o++)i=a.values[o],i.pk==t&&h[l].values.reindex(o,n)}r()}}),e+=1})}function d(t){return e("i.fa.fa-bars."+t+".pull-left","")}function c(t,n,a){var i=t.showIdentifierFields(),o=interpolate(gettext("Value %s Name"),[a+1]);return e("tr",{"data-id":n.pk},e("th",[d("value-sort-handle"),o]),l("td",n,"texts","",i),e("td",e("a.btn.text-danger.btn-xs",{href:"#",onclick:function(){return n.DELETE=!0,r(),!1}},e("i.fa.fa-times-circle")," "+gettext("Delete value"))))}function f(n,a){var o=n.showIdentifierFields(),u=e("a.btn.btn-xs.text-danger",{href:"#",onclick:function(){return 0===a.values.length||confirm(gettext("Are you sure?"))?(a.DELETE=!0,r(),!1):void 0}},e("i.fa.fa-times-circle")," "+gettext("Delete Variable")),f=e("a.btn.btn-xs.btn-text",{href:"#",onclick:function(e){a.values.push({pk:i(),identifier:"",texts:{}}),e.preventDefault()}},e("i.fa.fa-plus")," "+gettext("Add new value")),s=e("tr",[e("th",gettext("Variable Name"))].concat(l("td",a,"names","",o)).concat([e("td")])),v=t.map(t.reject(a.values,"DELETE"),t.partial(c,n));return e("div.product-variable",{key:a.pk},[e("div.variable-heading.clearfix",[d("variable-sort-handle"),e("h3.pull-left",gettext("Variable")),e("div.pull-right",u)]),e("div.variable-body",[e("div.table-responsive",[e("table.table.table-bordered",[e("thead",[e("tr",[e("th")].concat(t.map(p,function(t){var n=t.name;return e("th",n)})).concat([o?e("th",[gettext("Identifer")]):null,e("th")]))]),e("tbody.product-variable-name",s),e("tbody.product-variable-values",v)])]),e("div.new-row",f)])])}function s(n){var r=e("div.product-variable-wrap",{id:"product-variable-wrap"},t.map(t.reject(h,"DELETE"),t.partial(f,n))),l=e("p",[e("label.small",[e("input",{type:"checkbox",checked:!!n.showIdentifierFields(),onclick:e.withAttr("checked",n.showIdentifierFields)})," "+gettext("Show identifier fields (for advanced users)")])]);return h.length||(r=e("p.text-info",[e("i.fa.fa-exclamation-circle")," "+gettext("There are no variables defined."),e("hr")]),l=null),e("div",{config:a},[l,e("hr"),r,e("a.btn.btn-lg.btn-text",{href:"#",onclick:function(e){h.push({pk:i(),identifier:"",names:{},values:[]}),e.preventDefault()}},e("i.fa.fa-plus")," "+gettext("Add new variable"))])}function v(t){b||(p=t.languages,h=t.variables,window.VariationVariableEditor.ctrl=b=e.mount(document.getElementById("variation-variable-editor"),{controller:n,view:s}))}var p=null,h=null,b=null;return Array.prototype.reindex||(Array.prototype.reindex=function(e,t){this.splice(t,0,this.splice(e,1)[0])}),{init:v}}(window.m,window._);
//# sourceMappingURL=product-variation-variable-editor.js.map
